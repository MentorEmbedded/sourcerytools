Index: GNUmakefile.in
===================================================================
RCS file: /home/cvs/Repository/vpp/GNUmakefile.in,v
retrieving revision 1.29
diff -u -r1.29 GNUmakefile.in
--- GNUmakefile.in	13 Dec 2005 01:34:47 -0000	1.29
+++ GNUmakefile.in	19 Dec 2005 15:22:18 -0000
@@ -150,7 +150,9 @@
 hdr	:= $(patsubst $(srcdir)/src/%, %, $(wildcard $(srcdir)/src/vsip/*.hpp))
 hdr	+= $(patsubst $(srcdir)/src/%, %, $(wildcard $(srcdir)/src/vsip/impl/*.hpp))
 
-syn	:= $(patsubst %.hpp, src/%.syn, $(filter-out %fft-core.hpp, $(hdr)))
+syn	:= $(patsubst %.hpp, src/%.syn, \
+             $(filter-out %fft-core.hpp %signal-conv-ipp.hpp %signal-conv-sal.hpp, \
+             $(hdr)))
 
 ########################################################################
 # Functions
@@ -164,6 +166,25 @@
 # name of $(1).
 dir_var  = $($(call norm_dir,$(1))$(2))
 
+# Replace variables only during installation, when all final values are
+# known.
+define install_pc
+cat $(srcdir)/vsipl++.pc.in | \
+  sed -e "s|@prefix_@|$(prefix)|g" | \
+  sed -e "s|@exec_prefix_@|$(exec_prefix)|g" | \
+  sed -e "s|@libdir_@|$(libdir)|g" | \
+  sed -e "s|@includedir_@|$(includedir)|g" | \
+  sed -e "s|@CXX_@|$(CXX)|g" | \
+  sed -e "s|@CPPFLAGS_@|@CPPFLAGS@|g" | \
+  sed -e "s|@CXXFLAGS_@|@CXXFLAGS@|g" | \
+  sed -e "s|@LDFLAGS_@|$(LDFLAGS)|g" | \
+  sed -e "s|@LIBS_@|$(LIBS)|g" | \
+  sed -e "s|@VERSION_@|$(VERSION)|g" \
+  > vsipl++-installed.pc; \
+  $(INSTALL) -d $(libdir)/pkgconfig; \
+  $(INSTALL_DATA) vsipl++-installed.pc $(libdir)/pkgconfig/vsipl++.pc
+endef
+
 ########################################################################
 # Implicit Rules
 ########################################################################
@@ -263,8 +284,7 @@
 check::
 
 install::
-	$(INSTALL) -d $(libdir)/pkgconfig
-	$(INSTALL_DATA) vsipl++.pc $(libdir)/pkgconfig
+	$(install_pc)
 
 clean::
 	rm -f $(objects)
Index: vsipl++.pc.in
===================================================================
RCS file: /home/cvs/Repository/vpp/vsipl++.pc.in,v
retrieving revision 1.4
diff -u -r1.4 vsipl++.pc.in
--- vsipl++.pc.in	23 Aug 2005 19:32:52 -0000	1.4
+++ vsipl++.pc.in	19 Dec 2005 15:22:18 -0000
@@ -1,13 +1,14 @@
-prefix=@prefix@
-exec_prefix=@exec_prefix@
-libdir=@libdir@
-includedir=@includedir@
-cxx=@CXX@
-cppflags=@CPPFLAGS@
-cxxflags=@CXXFLAGS@
+prefix=@prefix_@
+exec_prefix=@exec_prefix_@
+libdir=@libdir_@
+includedir=@includedir_@
+cxx=@CXX_@
+cppflags=-I${includedir} @CPPFLAGS_@
+cxxflags=@CXXFLAGS_@
+ldflags=@LDFLAGS_@
 
 Name: Sourcery VSIPL++
 Description: CodeSourcery VSIPL++ library
-Version: @VERSION@
-Libs: @LDFLAGS@ -L${libdir} -lvsip @LIBS@
-Cflags: -I${includedir} @CPPFLAGS@
+Version: @VERSION_@
+Libs: ${ldflags} -L${libdir} -lvsip @LIBS_@
+Cflags: ${cppflags}
