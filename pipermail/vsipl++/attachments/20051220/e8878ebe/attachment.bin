
Index: GNUmakefile.in
===================================================================
RCS file: /home/cvs/Repository/vpp/GNUmakefile.in,v
retrieving revision 1.30
diff -c -p -r1.30 GNUmakefile.in
*** GNUmakefile.in	14 Dec 2005 17:30:31 -0000	1.30
--- GNUmakefile.in	20 Dec 2005 08:09:31 -0000
*************** USE_PAR := @USE_PAR@
*** 76,81 ****
--- 76,89 ----
  MPI_CPPFLAGS := @MPI_CPPFLAGS@
  MPI_LIBS := @MPI_LIBS@
  
+ ### Third-party package availability ###
+ 
+ VSIP_IMPL_HAVE_IPP := @VSIP_IMPL_HAVE_IPP@
+ VSIP_IMPL_HAVE_SAL := @VSIP_IMPL_HAVE_SAL@
+ VSIP_IMPL_HAVE_BLAS := @VSIP_IMPL_HAVE_BLAS@
+ VSIP_IMPL_HAVE_LAPACK := @VSIP_IMPL_HAVE_LAPACK@
+ 
+ 
  ### Documentation ### 
  
  # The location of the csl-docbook directory.
Index: configure.ac
===================================================================
RCS file: /home/cvs/Repository/vpp/configure.ac,v
retrieving revision 1.58
diff -c -p -r1.58 configure.ac
*** configure.ac	14 Dec 2005 17:30:31 -0000	1.58
--- configure.ac	20 Dec 2005 08:09:31 -0000
*************** if test "$with_lapack" != "no"; then
*** 1038,1045 ****
--- 1038,1047 ----
      LIBS=$keep_LIBS
    else
      AC_MSG_RESULT([Using $lapack_found for LAPACK])
+     AC_SUBST(VSIP_IMPL_HAVE_BLAS, 1)
      AC_DEFINE_UNQUOTED(VSIP_IMPL_HAVE_BLAS, 1,
        [Define to set whether or not BLAS is present.])
+     AC_SUBST(VSIP_IMPL_HAVE_LAPACK, 1)
      AC_DEFINE_UNQUOTED(VSIP_IMPL_HAVE_LAPACK, 1,
        [Define to set whether or not LAPACK is present.])
      AC_DEFINE_UNQUOTED(VSIP_IMPL_USE_LAPACK_ILAENV, $lapack_use_ilaenv,
Index: benchmarks/GNUmakefile.inc.in
===================================================================
RCS file: /home/cvs/Repository/vpp/benchmarks/GNUmakefile.inc.in,v
retrieving revision 1.2
diff -c -p -r1.2 GNUmakefile.inc.in
*** benchmarks/GNUmakefile.inc.in	13 Dec 2005 20:35:54 -0000	1.2
--- benchmarks/GNUmakefile.inc.in	20 Dec 2005 08:09:31 -0000
*************** benchmarks_cxx_exes_special   := benchma
*** 34,39 ****
--- 34,54 ----
  benchmarks_cxx_exes_def_build := $(filter-out $(benchmarks_cxx_exes_special), \
                                                $(benchmarks_cxx_exes)) 
  
+ # Do not build tests requiring packages that are unavailable
+ benchmarks_cxx_exes_lapack := benchmarks/qrd$(EXEEXT) 
+ ifndef VSIP_IMPL_HAVE_LAPACK
+   benchmarks_cxx_exes_def_build := $(filter-out 	\
+ 	$(benchmarks_cxx_exes_lapack), $(benchmarks_cxx_exes_def_build)) 
+ endif 
+ 
+ benchmarks_cxx_exes_ipp := benchmarks/conv_ipp$(EXEEXT)			\
+ 	benchmarks/fft_ipp$(EXEEXT) benchmarks/fft_ext_ipp$(EXEEXT)	\
+ 	benchmarks/vmul_ipp$(EXEEXT)
+ ifndef VSIP_IMPL_HAVE_IPP
+   benchmarks_cxx_exes_def_build := $(filter-out		\
+ 	$(benchmarks_cxx_exes_ipp), $(benchmarks_cxx_exes_def_build)) 
+ endif
+ 
  cxx_sources += $(benchmarks_cxx_sources)
  
  
*************** cxx_sources += $(benchmarks_cxx_sources)
*** 41,47 ****
  # Rules
  ########################################################################
  
! bench:: $(benchmarks_cxx_exec)
  
  # Object files will be deleted by the parent clean rule.
  clean::
--- 56,62 ----
  # Rules
  ########################################################################
  
! bench:: $(benchmarks_cxx_exes_def_build)
  
  # Object files will be deleted by the parent clean rule.
  clean::
*************** clean::
*** 49,58 ****
  
  $(benchmarks_cxx_exes_def_build): %$(EXEEXT) : %.$(OBJEXT) benchmarks/main.$(OBJEXT) src/vsip/libvsip.a
  	$(CXX) $(LDFLAGS) -o $@ $^ $(LIBS) || rm -f $@
- 
- xyz:
- 	@echo $(benchmarks_cxx_exes)
- 	@echo "--------------------------------------------------"
- 	@echo $(benchmarks_cxx_exes_def_build)
- 	@echo "--------------------------------------------------"
- 	@echo $(benchmarks_cxx_exes_special)
--- 64,66 ----
Index: benchmarks/dot.cpp
===================================================================
RCS file: /home/cvs/Repository/vpp/benchmarks/dot.cpp,v
retrieving revision 1.1
diff -c -p -r1.1 dot.cpp
*** benchmarks/dot.cpp	12 Oct 2005 12:45:05 -0000	1.1
--- benchmarks/dot.cpp	20 Dec 2005 08:09:32 -0000
*************** struct t_dot2
*** 107,113 ****
  
      typedef typename Vector<T>::block_type block_type;
  
!     typedef impl::Evaluator<impl::Op_prod_vv, impl::Return_scalar<T>,
                              impl::Op_list_2<block_type, block_type>, ImplTag>
  		Eval;
  
--- 107,113 ----
  
      typedef typename Vector<T>::block_type block_type;
  
!     typedef impl::Evaluator<impl::Op_prod_vv_dot, impl::Return_scalar<T>,
                              impl::Op_list_2<block_type, block_type>, ImplTag>
  		Eval;
  
Index: src/vsip/GNUmakefile.inc.in
===================================================================
RCS file: /home/cvs/Repository/vpp/src/vsip/GNUmakefile.inc.in,v
retrieving revision 1.9
diff -c -p -r1.9 GNUmakefile.inc.in
*** src/vsip/GNUmakefile.inc.in	12 Dec 2005 15:12:00 -0000	1.9
--- src/vsip/GNUmakefile.inc.in	20 Dec 2005 08:09:32 -0000
***************
*** 12,20 ****
  # Variables
  ########################################################################
  
- VSIP_IMPL_HAVE_IPP := @VSIP_IMPL_HAVE_IPP@
- VSIP_IMPL_HAVE_SAL := @VSIP_IMPL_HAVE_SAL@
- 
  src_vsip_CXXINCLUDES := -I$(srcdir)/src
  src_vsip_CXXFLAGS := $(src_vsip_CXXINCLUDES)
  
--- 12,17 ----
