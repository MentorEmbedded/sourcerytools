<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [power-gnu-discuss] Support for the MPC5554 (e200z6 core)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:power-gnu-discuss%40codesourcery.com?Subject=Re%3A%20%5Bpower-gnu-discuss%5D%20Support%20for%20the%20MPC5554%20%28e200z6%20core%29&In-Reply-To=%3C4A251E0D.90401%40westcontrol.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000031.html">
   <LINK REL="Next"  HREF="000033.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[power-gnu-discuss] Support for the MPC5554 (e200z6 core)</H1>
    <B>David Brown</B> 
    <A HREF="mailto:power-gnu-discuss%40codesourcery.com?Subject=Re%3A%20%5Bpower-gnu-discuss%5D%20Support%20for%20the%20MPC5554%20%28e200z6%20core%29&In-Reply-To=%3C4A251E0D.90401%40westcontrol.com%3E"
       TITLE="[power-gnu-discuss] Support for the MPC5554 (e200z6 core)">david at westcontrol.com
       </A><BR>
    <I>Tue Jun  2 12:41:49 UTC 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000031.html">[power-gnu-discuss] Support for the MPC5554 (e200z6 core)
</A></li>
        <LI>Next message: <A HREF="000033.html">[power-gnu-discuss] Support for the MPC5554 (e200z6 core)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32">[ date ]</a>
              <a href="thread.html#32">[ thread ]</a>
              <a href="subject.html#32">[ subject ]</a>
              <a href="author.html#32">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Andrew Dennison wrote:
&gt;<i> On Tue, Jun 2, 2009 at 4:44 PM, David Brown &lt;<A HREF="http://sourcerytools.com/cgi-bin/mailman/listinfo/power-gnu-discuss">david at westcontrol.com</A>&gt; wrote:
</I>&gt;&gt;<i> Andrew Dennison wrote:
</I>&gt;&gt;&gt;<i> Works for my 5554 code.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i> What -mcpu flag (and any other -m flags) do you use?  I can't find any that
</I>&gt;&gt;<i> cause gcc (latest 4.3.3 version) to generate SPE instructions for single
</I>&gt;&gt;<i> precision floating point.  It's easy to get the compiler to generate
</I>&gt;&gt;<i> standard &quot;book E&quot; floating point instructions (fmuls, etc.), but those don't
</I>&gt;&gt;<i> work on the 5554 as far as I understand.
</I>&gt;<i> 
</I>&gt;<i> David,
</I>&gt;<i> 
</I>&gt;<i> No other flags have been necessary (for floating point anyway), but
</I>&gt;<i> from memory powerpc-eabi-spe defaults to 8540 (e500). There are some
</I>&gt;<i> other issues where altivec instructions were generated in some cases!!
</I>&gt;<i> Another switch cleans this up. Embedded powerpc can be fun...
</I>&gt;<i> 
</I>&gt;<i> Earlier on (4.0, 4.1) I was using -fsingle-precision-constants (or
</I>&gt;<i> something like that) and this also triggered the spe single precision
</I>&gt;<i> instruction generation. However when I wanted to use VARGS I found
</I>&gt;<i> they were still promoted to double (normal c abi). The short-double
</I>&gt;<i> switch fixed this. We have had to browse gcc source on occasion to try
</I>&gt;<i> to work out how the options really work.
</I>&gt;<i> 
</I>&gt;<i> We are now using 4.4.0 but have used various versions of 4.0, 4.1, 4.2
</I>&gt;<i> and 4.3 along the way.
</I>&gt;<i> 
</I>&gt;<i> Hope this helps
</I>&gt;<i> 
</I>&gt;<i> Andrew
</I>&gt;<i> 
</I>
Did you build your own gcc?  So far I've just tried using CodeSourcery's 
&quot;lite&quot; download, which is 4.3.2.  If you've built your own version 
(which the &quot;powerpc-eabi-spi-&quot; prefix suggests - the CodeSourcery build 
I tried has simply powerpc-eabi- prefix, and IIRC has -mcpu=603 as 
default), then perhaps the build I have is not configured to support SPE 
instructions properly.  Compilation with -mcpu=8540 failed entirely (I 
can't remember the error message - I'm at a different computer at the 
moment), while using -mcpu=e500 (again, I don't have the details on 
hand) gave either pure software floating point, or &quot;book E&quot; hardware 
floating point.

It looks like we will be going for Code Worrier on this project - the 
nature of the customer and his project make it difficult to recommend a 
&quot;home-built&quot; version of gcc (though a pre-built and supported version 
from CodeSourcery would be fine), and Code Worrier's status as the 
&quot;standard&quot; toolchain for these devices trumps gcc's other advantages 
(open source, familiarity, etc.).  However, I'd still like to get to the 
bottom of this, both for my own curiosity, and for the possibility of 
using gcc with the MPC5554 on other projects.

Thanks for your help so far,

mvh.,

David


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000031.html">[power-gnu-discuss] Support for the MPC5554 (e200z6 core)
</A></li>
	<LI>Next message: <A HREF="000033.html">[power-gnu-discuss] Support for the MPC5554 (e200z6 core)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32">[ date ]</a>
              <a href="thread.html#32">[ thread ]</a>
              <a href="subject.html#32">[ subject ]</a>
              <a href="author.html#32">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://sourcerytools.com/cgi-bin/mailman/listinfo/power-gnu-discuss">More information about the power-gnu-discuss
mailing list</a><br>
</body></html>
