<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> pthread_cancel and EH: let's try this again
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:c%2B%2B-pthreads%40codesourcery.com?Subject=Re%3A%20pthread_cancel%20and%20EH%3A%20let%27s%20try%20this%20again&In-Reply-To=%3Cubr54l0wb.fsf%40boost-consulting.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000381.html">
   <LINK REL="Next"  HREF="000383.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>pthread_cancel and EH: let's try this again</H1>
    <B>David Abrahams</B> 
    <A HREF="mailto:c%2B%2B-pthreads%40codesourcery.com?Subject=Re%3A%20pthread_cancel%20and%20EH%3A%20let%27s%20try%20this%20again&In-Reply-To=%3Cubr54l0wb.fsf%40boost-consulting.com%3E"
       TITLE="pthread_cancel and EH: let's try this again">dave at boost-consulting.com
       </A><BR>
    <I>Fri Jul 15 12:16:52 UTC 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="000381.html">[c++-pthreads]  Re: pthread_cancel and EH: let's try this again
</A></li>
        <LI>Next message: <A HREF="000383.html">[c++-pthreads]  Re: pthread_cancel and EH: let's try this again
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#382">[ date ]</a>
              <a href="thread.html#382">[ thread ]</a>
              <a href="subject.html#382">[ subject ]</a>
              <a href="author.html#382">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Dave Butenhof &lt;<A HREF="http://sourcerytools.com/cgi-bin/mailman/listinfo/c++-pthreads">david.butenhof at hp.com</A>&gt; writes:

&gt;<i> You can try to say that C frames using POSIX cleanup cannot be 
</I>&gt;<i> interleaved with C++ frames; and that C++ frames using C++ cancel cannot 
</I>&gt;<i> be interleaved with frames using POSIX cleanup. But that makes no 
</I>&gt;<i> conceivable sense, and in practice is an unreasonable and infeasible 
</I>&gt;<i> restriction. They have to interoperate. They have to be the same.
</I>
I'm sure I'm missing something important here, but I'm going to barrel
ahead with my misconceptions anyway so that someone will set me
straight.

It's currently *very common* to write C++ code that assumes C++
exceptions must not propagate across the boundary between C++ and
other languages.  That is the status quo for many systems and
compilers.  Many, many C programs are not written with embedded
thread cleanups, and IMO it's almost unreasonably hard for a C
program to register all the cleanups it would need to maintain
invariants, because C lacks the necessary language support.  It's
typical that a C++ exception will be translated into something that
ordinary C code can understand in those cases.  &quot;Ordinary&quot; error
handling is hard enough in C.

So it would seem to me that the rule that &quot;C frames using POSIX
cleanup cannot be interleaved with C++ frames&quot; is probably already
being followed in a great deal of code.

&gt;<i> There has to be ONE cancellation mechanism. It has to propagate and 
</I>&gt;<i> behave as an exception because there's a vast body of existing code in 
</I>&gt;<i> many languages that already provides cleanup mechanisms based on 
</I>&gt;<i> exceptions, and POSIX cancel cleanup can also be implemented as an 
</I>&gt;<i> exception.
</I>
Yeah, but there's also a vast body of existing code that for practical
reasons has to assume that exceptions can't propagate across language
boundaries, and so has put other mechanisms in place to handle that
situation.

-- 
Dave Abrahams
Boost Consulting
www.boost-consulting.com


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000381.html">[c++-pthreads]  Re: pthread_cancel and EH: let's try this again
</A></li>
	<LI>Next message: <A HREF="000383.html">[c++-pthreads]  Re: pthread_cancel and EH: let's try this again
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#382">[ date ]</a>
              <a href="thread.html#382">[ thread ]</a>
              <a href="subject.html#382">[ subject ]</a>
              <a href="author.html#382">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://sourcerytools.com/cgi-bin/mailman/listinfo/c++-pthreads">More information about the c++-pthreads
mailing list</a><br>
</body></html>
