<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [c++-pthreads]  Re: pthread_cancel and EH: let's try this again
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:c%2B%2B-pthreads%40codesourcery.com?Subject=Re%3A%20%5Bc%2B%2B-pthreads%5D%20%20Re%3A%20pthread_cancel%20and%20EH%3A%20let%27s%20try%20this%20again&In-Reply-To=%3C20050719175912.GA8407%40tofu.dreamhost.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000449.html">
   <LINK REL="Next"  HREF="000456.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[c++-pthreads]  Re: pthread_cancel and EH: let's try this again</H1>
    <B>Nathan Myers</B> 
    <A HREF="mailto:c%2B%2B-pthreads%40codesourcery.com?Subject=Re%3A%20%5Bc%2B%2B-pthreads%5D%20%20Re%3A%20pthread_cancel%20and%20EH%3A%20let%27s%20try%20this%20again&In-Reply-To=%3C20050719175912.GA8407%40tofu.dreamhost.com%3E"
       TITLE="[c++-pthreads]  Re: pthread_cancel and EH: let's try this again">ncm at cantrip.org
       </A><BR>
    <I>Tue Jul 19 17:59:12 UTC 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="000449.html">pthread_cancel and EH: let's try this again
</A></li>
        <LI>Next message: <A HREF="000456.html">pthread_cancel and EH: let's try this again
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#454">[ date ]</a>
              <a href="thread.html#454">[ thread ]</a>
              <a href="subject.html#454">[ subject ]</a>
              <a href="author.html#454">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, Jul 19, 2005 at 01:51:34AM +0200, Alexander Terekhov wrote:
&gt;<i> Nathan Myers wrote:
</I>&gt;<i> &gt; On Mon, Jul 18, 2005 at 02:20:10AM +0200, Alexander Terekhov wrote:
</I>&gt;<i> &gt; &gt; Wil Evers wrote:
</I>&gt;<i> &gt; &gt; &gt;      {
</I>&gt;<i> &gt; &gt; &gt;        cancellation_manager enabler(true);
</I>&gt;<i> &gt; &gt; &gt;        some_cancellation_point();
</I>&gt;<i> &gt; &gt; &gt;      }
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Never do that in &quot;library&quot; code.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; First, it's not in &quot;library code&quot;.  It's in thread-main.
</I>&gt;<i> 
</I>&gt;<i> new_thread(library_call, arg);
</I>&gt;<i> 
</I>&gt;<i> Where's &quot;thread-main&quot;?
</I>
&quot;Thread-main&quot; is a conventional term in thread programming for the 
function whose activation record is at the bottom of the thread's 
stack.  This function cannot return without terminating the thread, 
just as program main() cannot return without exiting the program.

&gt;<i> &gt; Second, when the default is to have cancellation off, design
</I>&gt;<i> &gt; heurisitics change accordingly.   It would be perfectly reasonable
</I>&gt;<i> &gt; to enable (some form of) cancellation, temporarily, inside a library
</I>&gt;<i> &gt; that necessarily must have been called with it turned off.
</I>&gt;<i> 
</I>&gt;<i> And how would you really turn it off (depending on client's 
</I>&gt;<i> need/context), then?
</I>
If *I* didn't want the thread cancelled, I would simply choose not to 
cancel it.  If the client calls into a library that promises to throw 
if it can't satisfy its postconditions, then it might get an exception 
to deal with.  What was the question?

Nathan Myers
<A HREF="http://sourcerytools.com/cgi-bin/mailman/listinfo/c++-pthreads">ncm at codesourcery.com</A>
<A HREF="http://sourcerytools.com/cgi-bin/mailman/listinfo/c++-pthreads">ncm at cantrip.org</A>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000449.html">pthread_cancel and EH: let's try this again
</A></li>
	<LI>Next message: <A HREF="000456.html">pthread_cancel and EH: let's try this again
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#454">[ date ]</a>
              <a href="thread.html#454">[ thread ]</a>
              <a href="subject.html#454">[ subject ]</a>
              <a href="author.html#454">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://sourcerytools.com/cgi-bin/mailman/listinfo/c++-pthreads">More information about the c++-pthreads
mailing list</a><br>
</body></html>
