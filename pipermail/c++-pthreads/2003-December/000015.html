<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [c++-pthreads] cancellation points report failure
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:c%2B%2B-pthreads%40codesourcery.com?Subject=Re%3A%20%5Bc%2B%2B-pthreads%5D%20cancellation%20points%20report%20failure&In-Reply-To=%3Cuoeu4ijaa.fsf%40boost-consulting.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000013.html">
   <LINK REL="Next"  HREF="000017.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[c++-pthreads] cancellation points report failure</H1>
    <B>David Abrahams</B> 
    <A HREF="mailto:c%2B%2B-pthreads%40codesourcery.com?Subject=Re%3A%20%5Bc%2B%2B-pthreads%5D%20cancellation%20points%20report%20failure&In-Reply-To=%3Cuoeu4ijaa.fsf%40boost-consulting.com%3E"
       TITLE="[c++-pthreads] cancellation points report failure">dave at boost-consulting.com
       </A><BR>
    <I>Fri Dec 19 21:34:21 UTC 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="000013.html">[c++-pthreads] cancellation points report failure
</A></li>
        <LI>Next message: <A HREF="000017.html">[c++-pthreads] cancellation points report failure
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15">[ date ]</a>
              <a href="thread.html#15">[ thread ]</a>
              <a href="subject.html#15">[ subject ]</a>
              <a href="author.html#15">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Ted Baker &lt;<A HREF="http://sourcerytools.com/cgi-bin/mailman/listinfo/c++-pthreads">baker at cs.fsu.edu</A>&gt; writes:

&gt;<i> How do you propose to prevent cancelation occurring (i.e., the
</I>&gt;<i> thread starts executing the cleanup routines and then exits) if a
</I>&gt;<i> C++ library function uses an underlying C library call that is a
</I>&gt;<i> thread cancelation point?
</I>&gt;<i>
</I>&gt;<i> Are you figuring on redoing all the libraries to avoid calls
</I>&gt;<i> to such C functions?
</I>
One of us is very confused.  What you're talking about is the problem
we have today.  IIUC, Nathan was suggesting that read() should report
cancellation using the same means it uses to report failures to 'C'
programs, IOW, not by throwing an exception.  Maybe I've
misunderstood something?


&gt;&gt;<i> &gt;&gt; One possible solution (perhaps overly drastic): in C++, eliminate
</I>&gt;&gt;<i> &gt;&gt; all cancelation points except for pthread_testcancel.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Another would be for those functions identified as cancellation 
</I>&gt;&gt;<i> &gt; points to report failure.  In particular, a read() call should return 
</I>&gt;&gt;<i> &gt; immediately.  Existing (good) code has to handle normal failures 
</I>&gt;&gt;<i> &gt; already.  Well-designed library code will propagate the failure up 
</I>&gt;&gt;<i> &gt; to the point where a check for cancellation, and throw, may occur.  
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Ingenious!  I'm not sure about all the implications, but I think we
</I>&gt;&gt;<i> should explore this idea further.  In hindsight, it's almost obvious:
</I>&gt;&gt;<i> a function should only report failure in one way.  Requiring
</I>&gt;&gt;<i> programmers to deal with exceptions *and* failure status makes the
</I>&gt;&gt;<i> whole thing unwieldy and error-prone.
</I>&gt;<i>
</I>
-- 
Dave Abrahams
Boost Consulting
www.boost-consulting.com


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000013.html">[c++-pthreads] cancellation points report failure
</A></li>
	<LI>Next message: <A HREF="000017.html">[c++-pthreads] cancellation points report failure
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15">[ date ]</a>
              <a href="thread.html#15">[ thread ]</a>
              <a href="subject.html#15">[ subject ]</a>
              <a href="author.html#15">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://sourcerytools.com/cgi-bin/mailman/listinfo/c++-pthreads">More information about the c++-pthreads
mailing list</a><br>
</body></html>
