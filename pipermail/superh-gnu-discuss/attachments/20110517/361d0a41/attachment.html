<tt>
&lt;html&gt;&lt;body&gt;<br>
&lt;p&gt;&lt;tt&gt;&lt;font&nbsp;size=&quot;2&quot;&gt;Hi&nbsp;Andrew,&lt;/font&gt;&lt;/tt&gt;&lt;br&gt;<br>
&lt;tt&gt;&lt;font&nbsp;size=&quot;2&quot;&gt;&lt;br&gt;<br>
&gt;&nbsp;From:&nbsp;Andrew&nbsp;Stubbs&nbsp;&lt;ams@codesourcery.com&gt;&lt;/font&gt;&lt;/tt&gt;&lt;br&gt;<br>
&lt;tt&gt;&lt;font&nbsp;size=&quot;2&quot;&gt;&gt;&nbsp;To:&nbsp;PHIL.EDWORTHY@renesas.com&lt;/font&gt;&lt;/tt&gt;&lt;br&gt;<br>
&lt;tt&gt;&lt;font&nbsp;size=&quot;2&quot;&gt;&gt;&nbsp;Cc:&nbsp;&quot;superh-gnu-discuss@codesourcery.com&quot;&nbsp;&lt;superh-gnu-discuss@codesourcery.com&gt;&lt;/font&gt;&lt;/tt&gt;&lt;br&gt;<br>
&lt;tt&gt;&lt;font&nbsp;size=&quot;2&quot;&gt;&gt;&nbsp;Date:&nbsp;16/05/2011&nbsp;17:09&lt;/font&gt;&lt;/tt&gt;&lt;br&gt;<br>
&lt;tt&gt;&lt;font&nbsp;size=&quot;2&quot;&gt;&gt;&nbsp;Subject:&nbsp;Re:&nbsp;[superh-gnu-discuss]&nbsp;SH2A&nbsp;uCLinux&nbsp;toolchain&lt;/font&gt;&lt;/tt&gt;&lt;br&gt;<br>
&lt;tt&gt;&lt;font&nbsp;size=&quot;2&quot;&gt;&gt;&nbsp;Sent&nbsp;by:&nbsp;ams@codesourcery.com&lt;/font&gt;&lt;/tt&gt;&lt;br&gt;<br>
&lt;tt&gt;&lt;font&nbsp;size=&quot;2&quot;&gt;&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;On&nbsp;16/05/11&nbsp;16:32,&nbsp;PHIL.EDWORTHY@renesas.com&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;The&nbsp;toolchain&nbsp;is&nbsp;only&nbsp;provided&nbsp;with&nbsp;fdpic&nbsp;libraries,&nbsp;but&nbsp;this&nbsp;is&nbsp;only&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;useful&nbsp;for&nbsp;userspace&nbsp;code&nbsp;afaik.&nbsp;The&nbsp;kernel&nbsp;already&nbsp;forces&nbsp;-mno-fdpic,&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;so&nbsp;should&nbsp;I&nbsp;use&nbsp;this&nbsp;option&nbsp;with&nbsp;U-Boot&nbsp;as&nbsp;well?&lt;br&gt;<br>
&gt;&nbsp;&gt;&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;The&nbsp;problem&nbsp;is&nbsp;that&nbsp;both&nbsp;the&nbsp;kernel,&nbsp;when&nbsp;building&nbsp;a&nbsp;zImage,&nbsp;and&nbsp;U-Boot,&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;link&nbsp;against&nbsp;libgcc.&nbsp;This&nbsp;leads&nbsp;to&nbsp;&quot;attempt&nbsp;to&nbsp;mix&nbsp;FDPIC&nbsp;and&nbsp;non-FDPIC&lt;br&gt;<br>
&gt;&nbsp;&gt;&nbsp;objects&quot;&nbsp;errors.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;The&nbsp;problem&nbsp;is&nbsp;that&nbsp;libgcc&nbsp;(a&nbsp;behind-the-scenes&nbsp;library&nbsp;containing&nbsp;&lt;br&gt;<br>
&gt;&nbsp;essential&nbsp;helper&nbsp;functions&nbsp;for&nbsp;compiled&nbsp;code)&nbsp;is&nbsp;compiled&nbsp;for&nbsp;FDPIC.&nbsp;&lt;br&gt;<br>
&gt;&nbsp;This&nbsp;is&nbsp;necessary&nbsp;for&nbsp;user-space,&nbsp;as&nbsp;you&nbsp;say.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;The&nbsp;kernel&nbsp;and&nbsp;u-boot&nbsp;are&nbsp;special&nbsp;cases&nbsp;in&nbsp;that&nbsp;they&nbsp;are&nbsp;bare-metal&nbsp;&lt;br&gt;<br>
&gt;&nbsp;applications&nbsp;that&nbsp;are&nbsp;typically&nbsp;built&nbsp;with&nbsp;a&nbsp;(normally&nbsp;unsuitable)&nbsp;&lt;br&gt;<br>
&gt;&nbsp;Linux/uClinux&nbsp;user-space&nbsp;toolchain.&nbsp;This&nbsp;means&nbsp;they&nbsp;should&nbsp;provide&nbsp;a&nbsp;&lt;br&gt;<br>
&gt;&nbsp;complete&nbsp;set&nbsp;of&nbsp;libgcc-compatible&nbsp;replacement&nbsp;routines&nbsp;that&nbsp;work&nbsp;in&nbsp;a&nbsp;&lt;br&gt;<br>
&gt;&nbsp;bare-metal&nbsp;context.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;The&nbsp;kernel&nbsp;does,&nbsp;in&nbsp;fact,&nbsp;provide&nbsp;sufficient&nbsp;routines&nbsp;to&nbsp;build&nbsp;a&nbsp;normal&nbsp;&lt;br&gt;<br>
&gt;&nbsp;kernel,&nbsp;but&nbsp;apparently&nbsp;is&nbsp;missing&nbsp;(at&nbsp;least)&nbsp;one&nbsp;used&nbsp;by&nbsp;the&nbsp;compressed&nbsp;&lt;br&gt;<br>
&gt;&nbsp;kernel.&nbsp;I'm&nbsp;not&nbsp;familiar&nbsp;with&nbsp;U-boot,&nbsp;but&nbsp;presumably&nbsp;it&nbsp;should&nbsp;be&nbsp;doing&nbsp;&lt;br&gt;<br>
&gt;&nbsp;the&nbsp;same.&nbsp;You&nbsp;can&nbsp;probably&nbsp;copy&nbsp;many&nbsp;of&nbsp;the&nbsp;routines&nbsp;from&nbsp;the&nbsp;kernel&nbsp;&lt;br&gt;<br>
&gt;&nbsp;sources.&nbsp;The&nbsp;rest&nbsp;can&nbsp;be&nbsp;obtained&nbsp;from&nbsp;the&nbsp;compiler&nbsp;sources,&nbsp;or&nbsp;by&nbsp;&lt;br&gt;<br>
&gt;&nbsp;building&nbsp;a&nbsp;reconfigured&nbsp;compiler.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;Note&nbsp;that&nbsp;this&nbsp;problem&nbsp;is&nbsp;not&nbsp;SH-specific,&nbsp;but&nbsp;true&nbsp;on&nbsp;all&nbsp;platforms.&nbsp;&lt;br&gt;<br>
&gt;&nbsp;That&nbsp;said,&nbsp;the&nbsp;FDPIC&nbsp;user-space&nbsp;*is*&nbsp;more&nbsp;incompatible&nbsp;with&nbsp;bare-metal&nbsp;&lt;br&gt;<br>
&gt;&nbsp;than&nbsp;in&nbsp;most&nbsp;cases.&lt;br&gt;<br>
&gt;&lt;/font&gt;&lt;/tt&gt;&lt;br&gt;<br>
&lt;tt&gt;&lt;font&nbsp;size=&quot;2&quot;&gt;&gt;&nbsp;&gt;&nbsp;So&nbsp;my&nbsp;question&nbsp;is,&nbsp;how&nbsp;can&nbsp;I&nbsp;use&nbsp;this&nbsp;toolchain&nbsp;for&nbsp;uCLinux&nbsp;development?&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;The&nbsp;toolchain&nbsp;can&nbsp;be&nbsp;used&nbsp;for&nbsp;user-space&nbsp;uClinux&nbsp;development,&nbsp;but&nbsp;the&nbsp;&lt;br&gt;<br>
&gt;&nbsp;kernel&nbsp;and&nbsp;u-boot&nbsp;must&nbsp;either&nbsp;be&nbsp;built&nbsp;with&nbsp;a&nbsp;bare-metal&nbsp;toolchain,&nbsp;or&nbsp;&lt;br&gt;<br>
&gt;&nbsp;else&nbsp;have&nbsp;patches&nbsp;applied&nbsp;to&nbsp;work&nbsp;with&nbsp;the&nbsp;Linux&nbsp;toolchain&nbsp;(as&nbsp;the&nbsp;&lt;br&gt;<br>
&gt;&nbsp;kernel&nbsp;mostly&nbsp;does).&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;Sorry,&nbsp;but&nbsp;the&nbsp;our&nbsp;Renesas&nbsp;contract&nbsp;does&nbsp;not&nbsp;specify&nbsp;any&nbsp;bare-metal&nbsp;&lt;br&gt;<br>
&gt;&nbsp;configurations.&nbsp;If&nbsp;you&nbsp;think&nbsp;that&nbsp;should&nbsp;be&nbsp;changed,&nbsp;I&nbsp;believe&nbsp;you&nbsp;&lt;br&gt;<br>
&gt;&nbsp;should&nbsp;talk&nbsp;to&nbsp;Paul&nbsp;Mundt&nbsp;or&nbsp;Hisao&nbsp;Munakata&nbsp;on&nbsp;your&nbsp;side.&nbsp;Paul&nbsp;might&nbsp;&lt;br&gt;<br>
&gt;&nbsp;also&nbsp;have&nbsp;a&nbsp;technical&nbsp;solution&nbsp;for&nbsp;u-boot&nbsp;already.&lt;br&gt;<br>
&lt;/font&gt;&lt;/tt&gt;&lt;br&gt;<br>
&lt;tt&gt;&lt;font&nbsp;size=&quot;2&quot;&gt;Ok,&nbsp;that's&nbsp;a&nbsp;nice&nbsp;and&nbsp;clear&nbsp;summary,&nbsp;thanks.&nbsp;I'll&nbsp;talk&nbsp;to&nbsp;Paul&nbsp;about&nbsp;uboot.&lt;/font&gt;&lt;/tt&gt;&lt;br&gt;<br>
&lt;tt&gt;&lt;font&nbsp;size=&quot;2&quot;&gt;Phil&lt;/font&gt;&lt;/tt&gt;&lt;br&gt;<br>
&lt;/body&gt;&lt;/html&gt;
</tt>
