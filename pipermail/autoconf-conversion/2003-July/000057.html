<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [autoconf-conversion] Re: Toplevel configury, multilibs, new autoconf versions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:autoconf-conversion%40codesourcery.com?Subject=Re%3A%20%5Bautoconf-conversion%5D%20Re%3A%20Toplevel%20configury%2C%20multilibs%2C%20new%20autoconf%20versions&In-Reply-To=%3C20030728000105.GB24231%40disaster.jaj.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000055.html">
   <LINK REL="Next"  HREF="000058.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[autoconf-conversion] Re: Toplevel configury, multilibs, new autoconf versions</H1>
    <B>Phil Edwards</B> 
    <A HREF="mailto:autoconf-conversion%40codesourcery.com?Subject=Re%3A%20%5Bautoconf-conversion%5D%20Re%3A%20Toplevel%20configury%2C%20multilibs%2C%20new%20autoconf%20versions&In-Reply-To=%3C20030728000105.GB24231%40disaster.jaj.com%3E"
       TITLE="[autoconf-conversion] Re: Toplevel configury, multilibs, new autoconf versions">phil at jaj.com
       </A><BR>
    <I>Mon Jul 28 00:01:05 UTC 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="000055.html">[autoconf-conversion] Re: Toplevel configury, multilibs, new autoconf versions
</A></li>
        <LI>Next message: <A HREF="000058.html">[autoconf-conversion] Re: Toplevel configury, multilibs, new autoconf versions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#57">[ date ]</a>
              <a href="thread.html#57">[ thread ]</a>
              <a href="subject.html#57">[ subject ]</a>
              <a href="author.html#57">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sun, Jul 27, 2003 at 07:50:40PM -0400, Daniel Jacobowitz wrote:
&gt;<i> On Sun, Jul 27, 2003 at 07:33:13PM -0400, Phil Edwards wrote:
</I>&gt;<i> &gt; To be both safe and helpful, the configure script actually stores those
</I>&gt;<i> &gt; variables into the generated config.status file -- pay attention now --
</I>&gt;<i> &gt; as if they had been specified on the command line.  The shell variable
</I>&gt;<i> &gt; which stores command-line arguments is augmented with those &quot;precious&quot;
</I>&gt;<i> &gt; environment variables.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; So when a multilib run is fired off with configure generated by 2.57,
</I>&gt;<i> &gt; the created primary config.status source's config-ml.in, which then does
</I>&gt;<i> &gt; this just as before:
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt;     Multilib=`echo Primary | sed '.....'`
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt;     CXX=Multilib $srcdir/configure --stuff 'CXX=Primary'
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; When configure examines the command line and sees variable assignments,
</I>&gt;<i> &gt; it performs them without examining the current environment.  It does this
</I>&gt;<i> &gt; for safety, because it thinks the user is rerunning configure.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; That sound you hear is configure wailing, &quot;MY PRECIOUSSSSSSSS!&quot; as it
</I>&gt;<i> &gt; overwrites Multilib with Primary.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; I've made a couple of half-hearted attempts to defeat this from within
</I>&gt;<i> &gt; libstdc++'s acinclude.m4, but autoconf is too smart for me.
</I>&gt;<i> 
</I>&gt;<i> Can't you just modify what config.status thinks the command line was,
</I>&gt;<i> at this point?  Either to correct Primary, or to append CXX=Multilib?
</I>&gt;<i> Presumably from within config-ml.in.
</I>
Correcting Primary is tricky without the toplevel knowing more about
multilibs.  Appending CXX=Multilib would have to be done within config-ml.in,
and I believe would work, but would also break all 2.13-style configures,
which (IIRC) didn't understand env assignments as command-line arguments.


Phil

-- 
If ye love wealth greater than liberty, the tranquility of servitude greater
than the animating contest for freedom, go home and leave us in peace.  We seek
not your counsel, nor your arms.  Crouch down and lick the hand that feeds you;
and may posterity forget that ye were our countrymen.            - Samuel Adams

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000055.html">[autoconf-conversion] Re: Toplevel configury, multilibs, new autoconf versions
</A></li>
	<LI>Next message: <A HREF="000058.html">[autoconf-conversion] Re: Toplevel configury, multilibs, new autoconf versions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#57">[ date ]</a>
              <a href="thread.html#57">[ thread ]</a>
              <a href="subject.html#57">[ subject ]</a>
              <a href="author.html#57">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://sourcerytools.com/cgi-bin/mailman/listinfo/autoconf-conversion">More information about the autoconf-conversion
mailing list</a><br>
</body></html>
