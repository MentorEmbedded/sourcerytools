<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> PATCH: Enhance DejaGNU result reader
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:qmtest%40codesourcery.com?Subject=Re%3A%20PATCH%3A%20Enhance%20DejaGNU%20result%20reader&In-Reply-To=%3C435C90D9.4060005%40codesourcery.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001095.html">
   <LINK REL="Next"  HREF="001098.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>PATCH: Enhance DejaGNU result reader</H1>
    <B>Mark Mitchell</B> 
    <A HREF="mailto:qmtest%40codesourcery.com?Subject=Re%3A%20PATCH%3A%20Enhance%20DejaGNU%20result%20reader&In-Reply-To=%3C435C90D9.4060005%40codesourcery.com%3E"
       TITLE="PATCH: Enhance DejaGNU result reader">mark at codesourcery.com
       </A><BR>
    <I>Mon Oct 24 07:44:25 UTC 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="001095.html">PATCH: Support extension descriptors in qmtest summarize input file
</A></li>
        <LI>Next message: <A HREF="001098.html">[qmtest] PATCH: Enhance DejaGNU result reader
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1096">[ date ]</a>
              <a href="thread.html#1096">[ thread ]</a>
              <a href="subject.html#1096">[ subject ]</a>
              <a href="author.html#1096">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>QMTest has had a ResultReader that could parse DejaGNU .log files for
some time.  This patch enhances that reader in two respects.

First, the reader now offers a &quot;combined&quot; mode.  DejaGNU often applies
multiple separate tests in situations which QMTest would probably group
together into a single test.  For example, here's an extra from a
DejaGNU log file for G++:

FAIL: g++.dg/other/switch2.C  (test for errors, line 16)
FAIL: g++.dg/other/switch2.C  (test for errors, line 17)
FAIL: g++.dg/other/switch2.C  (test for errors, line 18)
FAIL: g++.dg/other/switch2.C  (test for errors, line 19)
FAIL: g++.dg/other/switch2.C  (test for errors, line 20)
PASS: g++.dg/other/switch2.C (test for excess errors)

All that comes from source file, which the compiler is supposed to
compile.  DejaGNU is checking that errors appear on the lines where they
should, and that no additional errors appear.  In QMTest, it would be
natural to have a test class that compiled the file, and PASSed only if
all of the right things happened, and failed otherwise, because most
people talk about &quot;the test switch2.C&quot;, not &quot;the test
switch2.C-errors-on-line-16&quot;.

Until now, the DejaGNU reader only let you read in results in the
DejaGNU model, so that the above would be six separate results.  That
mode is still present, but the new &quot;combined&quot; mode combines the DejaGNU
results into a single result:

  g++.dg/other/switch2.C                        : FAIL

    Test for errors, line 16. Test for errors, line 17. Test for errors,
    line 18. Test for errors, line 19. Test for errors, line 20.

The second enhancement is a &quot;generate-expectations&quot; mode.  DejaGNU
stores information about expected passage and failure in the testsuite
itself, rather than using QMTest's &quot;todays results are tomorrows
expectations&quot; approach.  In order to provide an analog, in the
generate-expectations mode, the results generated by QMTest reflect not
the actual reuslts in the DejaGNU .log file, but the DejaGNU
expectations for those results.  So, a command like:

  qmtest summarize \
    -O &quot;dejagnu_stream.DejaGNUReader(filename = 'gcc.log', \
                                     expectations = 'true')&quot; \
    gcc.log

will show the same unexpected failures in QMTest as would be shown by
DejaGNU, if 'gcc.log' is a DejaGNU log file.

(Note that here we're using the extension descriptor syntax to construct
a result readers for the expected outcomes, using a non-default
argument, while for the principal input we're content to use the default
mode.)

-- 
Mark Mitchell
CodeSourcery, LLC
<A HREF="http://sourcerytools.com/cgi-bin/mailman/listinfo/qmtest">mark at codesourcery.com</A>
(916) 791-8304
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: qmtest.patch
URL: &lt;<A HREF="http://sourcerytools.com/pipermail/qmtest/attachments/20051024/06db4a21/attachment.ksh">http://sourcerytools.com/pipermail/qmtest/attachments/20051024/06db4a21/attachment.ksh</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001095.html">PATCH: Support extension descriptors in qmtest summarize input file
</A></li>
	<LI>Next message: <A HREF="001098.html">[qmtest] PATCH: Enhance DejaGNU result reader
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1096">[ date ]</a>
              <a href="thread.html#1096">[ thread ]</a>
              <a href="subject.html#1096">[ subject ]</a>
              <a href="author.html#1096">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://sourcerytools.com/cgi-bin/mailman/listinfo/qmtest">More information about the qmtest
mailing list</a><br>
</body></html>
