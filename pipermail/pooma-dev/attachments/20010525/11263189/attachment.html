<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;3.2//EN&quot;&gt;<br>
&lt;HTML&gt;<br>
&lt;HEAD&gt;<br>
&lt;META&nbsp;HTTP-EQUIV=&quot;Content-Type&quot;&nbsp;CONTENT=&quot;text/html;&nbsp;charset=iso-8859-1&quot;&gt;<br>
&lt;META&nbsp;NAME=&quot;Generator&quot;&nbsp;CONTENT=&quot;MS&nbsp;Exchange&nbsp;Server&nbsp;version&nbsp;5.5.2650.12&quot;&gt;<br>
&lt;TITLE&gt;RE:&nbsp;[pooma-dev]&nbsp;RFA:&nbsp;delete_test1&nbsp;Modifications&lt;/TITLE&gt;<br>
&lt;/HEAD&gt;<br>
&lt;BODY&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;That's&nbsp;fine.&nbsp;Like&nbsp;I&nbsp;said,&nbsp;it&nbsp;doesn't&nbsp;matter&nbsp;here&nbsp;as&nbsp;this&nbsp;is&nbsp;just&nbsp;a&nbsp;test.&nbsp;Julian&nbsp;commented&nbsp;out&nbsp;the&nbsp;corresponding&nbsp;code&nbsp;in&nbsp;algorithm.h&nbsp;so&nbsp;we're&nbsp;not&nbsp;using&nbsp;this&nbsp;optimization&nbsp;in&nbsp;real&nbsp;code&nbsp;anyway.&lt;/FONT&gt;&lt;/P&gt;<br>
<br>
&lt;P&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;FONT&nbsp;SIZE=2&gt;Jim&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;-----Original&nbsp;Message-----&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;From:&nbsp;Jeffrey&nbsp;Oldham&nbsp;[&lt;A&nbsp;HREF=&quot;mailto:oldham@codesourcery.com&quot;&gt;mailto:oldham@codesourcery.com&lt;/A&gt;]&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;Sent:&nbsp;Thursday,&nbsp;May&nbsp;24,&nbsp;2001&nbsp;7:33&nbsp;PM&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;To:&nbsp;James&nbsp;Crotinger&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;Cc:&nbsp;pooma-dev@pooma.codesourcery.com&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;Subject:&nbsp;Re:&nbsp;[pooma-dev]&nbsp;RFA:&nbsp;delete_test1&nbsp;Modifications&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;On&nbsp;Thu,&nbsp;May&nbsp;24,&nbsp;2001&nbsp;at&nbsp;04:17:54PM&nbsp;-0700,&nbsp;James&nbsp;Crotinger&nbsp;wrote:&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;&gt;&nbsp;copy&nbsp;doesn't&nbsp;have&nbsp;the&nbsp;same&nbsp;semantics&nbsp;as&nbsp;memmove&nbsp;and&nbsp;so&nbsp;it&nbsp;&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;is&nbsp;potentially&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;&gt;&nbsp;faster&nbsp;(it&nbsp;can&nbsp;only&nbsp;copy&nbsp;overlapping&nbsp;regions&nbsp;if&nbsp;the&nbsp;&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;destination&nbsp;is&nbsp;before&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;&gt;&nbsp;the&nbsp;source,&nbsp;which&nbsp;is&nbsp;the&nbsp;case&nbsp;in&nbsp;the&nbsp;shift-up&nbsp;copies,&nbsp;which&nbsp;&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;almost&nbsp;always&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;&gt;&nbsp;involve&nbsp;overlapping&nbsp;regions).&nbsp;However,&nbsp;I&nbsp;did&nbsp;a&nbsp;lot&nbsp;of&nbsp;&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;testing&nbsp;with&nbsp;KCC&nbsp;on&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;&gt;&nbsp;the&nbsp;SGI&nbsp;and&nbsp;found&nbsp;that&nbsp;for&nbsp;larger&nbsp;moves,&nbsp;memmove&nbsp;was&nbsp;&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;faster.&nbsp;This&nbsp;is&nbsp;why&nbsp;I&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;&gt;&nbsp;put&nbsp;a&nbsp;test&nbsp;into&nbsp;the&nbsp;delete_shiftup&nbsp;algorithm&nbsp;to&nbsp;use&nbsp;copy&nbsp;&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;only&nbsp;if&nbsp;the&nbsp;length&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;&gt;&nbsp;of&nbsp;the&nbsp;copy&nbsp;was&nbsp;less&nbsp;than&nbsp;100&nbsp;(a&nbsp;good&nbsp;round&nbsp;number).&nbsp;&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;Someone&nbsp;(named&nbsp;julianc)&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;&gt;&nbsp;has&nbsp;since&nbsp;commented&nbsp;out&nbsp;that&nbsp;code&nbsp;without&nbsp;leaving&nbsp;a&nbsp;comment&nbsp;&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;in&nbsp;the&nbsp;source&nbsp;as&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;&gt;&nbsp;to&nbsp;the&nbsp;reason.&nbsp;Looking&nbsp;at&nbsp;the&nbsp;log&nbsp;I&nbsp;see&nbsp;that&nbsp;it&nbsp;was&nbsp;due&nbsp;to&nbsp;&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;VC++&nbsp;not&nbsp;having&nbsp;a&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;&gt;&nbsp;proper&nbsp;std::advance.&nbsp;This&nbsp;should&nbsp;have&nbsp;just&nbsp;been&nbsp;coded&nbsp;&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;around.&nbsp;At&nbsp;any&nbsp;rate,&nbsp;I&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;&gt;&nbsp;didn't&nbsp;add&nbsp;this&nbsp;complication&nbsp;lightly.&nbsp;Now&nbsp;perhaps&nbsp;KCC&nbsp;has&nbsp;&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;since&nbsp;written&nbsp;copy&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;&gt;&nbsp;to&nbsp;use&nbsp;memmove&nbsp;so&nbsp;I&nbsp;don't&nbsp;know&nbsp;if&nbsp;my&nbsp;investigations&nbsp;from&nbsp;&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;early&nbsp;2000&nbsp;are&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;&gt;&nbsp;still&nbsp;valid.&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;&gt;&nbsp;&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;&gt;&nbsp;&nbsp;&nbsp;Jim&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;&gt;&nbsp;&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;&gt;&nbsp;&gt;&nbsp;For&nbsp;those&nbsp;skipping&nbsp;intermediary&nbsp;emails,&nbsp;the&nbsp;discussion&nbsp;is&nbsp;whether&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;&gt;&nbsp;&gt;&nbsp;memmove()&nbsp;is&nbsp;faster&nbsp;than&nbsp;copy().&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;&gt;&nbsp;&gt;&nbsp;&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;&gt;&nbsp;&gt;&nbsp;Attached&nbsp;is&nbsp;a&nbsp;program&nbsp;that&nbsp;constructs&nbsp;a&nbsp;vector,&nbsp;copies&nbsp;&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;its&nbsp;contents&nbsp;to&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;&gt;&nbsp;&gt;&nbsp;another&nbsp;vector,&nbsp;and&nbsp;then&nbsp;checks&nbsp;the&nbsp;copy&nbsp;for&nbsp;correctness.&nbsp;&nbsp;On&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;&gt;&nbsp;&gt;&nbsp;Linux/gcc3.0&nbsp;and&nbsp;Irix6.5/KCC,&nbsp;I&nbsp;cannot&nbsp;find&nbsp;any&nbsp;significant&nbsp;speed&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;&gt;&nbsp;&gt;&nbsp;difference&nbsp;between&nbsp;std::copy&nbsp;and&nbsp;std::memmove&nbsp;for&nbsp;vectors&nbsp;&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;of&nbsp;doubles.&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;&gt;&nbsp;&gt;&nbsp;Given&nbsp;this&nbsp;result,&nbsp;may&nbsp;we&nbsp;use&nbsp;std::copy()&nbsp;everywhere&nbsp;since&nbsp;it&nbsp;is&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;&gt;&nbsp;&gt;&nbsp;guaranteed&nbsp;to&nbsp;compile?&nbsp;&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;OK,&nbsp;I&nbsp;am&nbsp;not&nbsp;going&nbsp;to&nbsp;argue&nbsp;with&nbsp;your&nbsp;timing&nbsp;data&nbsp;even&nbsp;though&nbsp;I&nbsp;cannot&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;reproduce&nbsp;them.&nbsp;&nbsp;Let's&nbsp;just&nbsp;end&nbsp;up&nbsp;with&nbsp;a&nbsp;program&nbsp;that&nbsp;compiles&nbsp;and&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;uses&nbsp;std::memmove.&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;OK&nbsp;to&nbsp;commit&nbsp;this&nbsp;patch?&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;Compiling&nbsp;src/Utilities/tests/delete_test1.cpp&nbsp;showed&nbsp;that&nbsp;the&nbsp;vector&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;type&nbsp;`Array_t'&nbsp;was&nbsp;declared&nbsp;to&nbsp;store&nbsp;doubles&nbsp;but&nbsp;actually&nbsp;stored&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;integers.&nbsp;&nbsp;Also,&nbsp;arguments&nbsp;for&nbsp;a&nbsp;call&nbsp;to&nbsp;std::memmove()&nbsp;was&nbsp;modified&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;to&nbsp;permit&nbsp;compilation.&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;2001&nbsp;May&nbsp;24&nbsp;&nbsp;Jeffrey&nbsp;D.&nbsp;Oldham&nbsp;&nbsp;&lt;oldham@codesourcery.com&gt;&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;delete_test1.cpp&nbsp;(Array_t):&nbsp;s/vector&lt;double&gt;/vector&lt;int&gt;/&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(delete_shiftup_test2):&nbsp;Modify&nbsp;memmove&nbsp;operands&nbsp;to&nbsp;&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;permit&nbsp;compilation.&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;Tested&nbsp;on&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sequential&nbsp;Linux&nbsp;using&nbsp;gcc&nbsp;3.0&nbsp;by&nbsp;compiling&nbsp;&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;the&nbsp;program&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;Approved&nbsp;by&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;???you???&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;Thanks,&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;Jeffrey&nbsp;D.&nbsp;Oldham&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;oldham@codesourcery.com&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&gt;&nbsp;&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;/BODY&gt;<br>
&lt;/HTML&gt;
</tt>
