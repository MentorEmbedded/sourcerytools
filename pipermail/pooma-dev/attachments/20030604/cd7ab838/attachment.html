<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;3.2//EN&quot;&gt;<br>
&lt;HTML&gt;<br>
&lt;HEAD&gt;<br>
&lt;META&nbsp;HTTP-EQUIV=&quot;Content-Type&quot;&nbsp;CONTENT=&quot;text/html;&nbsp;charset=us-ascii&quot;&gt;<br>
&lt;META&nbsp;NAME=&quot;Generator&quot;&nbsp;CONTENT=&quot;MS&nbsp;Exchange&nbsp;Server&nbsp;version&nbsp;5.5.2653.12&quot;&gt;<br>
&lt;TITLE&gt;RE:&nbsp;[pooma-dev]&nbsp;Brick&nbsp;engine&nbsp;and&nbsp;pointer&nbsp;aliasing&lt;/TITLE&gt;<br>
&lt;/HEAD&gt;<br>
&lt;BODY&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;I&nbsp;don't&nbsp;know&nbsp;where&nbsp;the&nbsp;code&nbsp;base&nbsp;ended&nbsp;up,&nbsp;but&nbsp;it&nbsp;used&nbsp;to&nbsp;be&nbsp;that&nbsp;we&nbsp;did&nbsp;a&nbsp;dependency&nbsp;analysis&nbsp;and&nbsp;if&nbsp;we&nbsp;detected&nbsp;the&nbsp;same&nbsp;block&nbsp;in&nbsp;use&nbsp;on&nbsp;the&nbsp;RHS&nbsp;that&nbsp;would&nbsp;be&nbsp;assigned&nbsp;to&nbsp;on&nbsp;the&nbsp;LHS,&nbsp;we&nbsp;allocated&nbsp;a&nbsp;new&nbsp;array,&nbsp;assigned&nbsp;results&nbsp;into&nbsp;it,&nbsp;and&nbsp;then&nbsp;copied&nbsp;the&nbsp;results&nbsp;back&nbsp;into&nbsp;the&nbsp;original&nbsp;target&nbsp;array.&nbsp;A&nbsp;lot&nbsp;of&nbsp;that&nbsp;sort&nbsp;of&nbsp;analysis&nbsp;got&nbsp;removed&nbsp;in&nbsp;the&nbsp;push&nbsp;to&nbsp;get&nbsp;2.3&nbsp;out&nbsp;before&nbsp;we&nbsp;left,&nbsp;though,&nbsp;so&nbsp;it&nbsp;may&nbsp;be&nbsp;gone,&nbsp;in&nbsp;which&nbsp;case&nbsp;certain&nbsp;statements&nbsp;that&nbsp;used&nbsp;to&nbsp;be&nbsp;well-defined&nbsp;would&nbsp;now&nbsp;be&nbsp;undefined.&nbsp;&lt;/FONT&gt;&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;With&nbsp;respect&nbsp;to&nbsp;restrict,&nbsp;we&nbsp;tried&nbsp;this&nbsp;at&nbsp;various&nbsp;times&nbsp;and&nbsp;found&nbsp;it&nbsp;not&nbsp;to&nbsp;help.&nbsp;With&nbsp;KCC,&nbsp;it&nbsp;wasn't&nbsp;properly&nbsp;propagated&nbsp;to&nbsp;the&nbsp;generated&nbsp;C&nbsp;code&nbsp;-&nbsp;they&nbsp;were&nbsp;not&nbsp;able&nbsp;to&nbsp;carry&nbsp;out&nbsp;the&nbsp;analysis&nbsp;carefully&nbsp;enough&nbsp;to&nbsp;label&nbsp;the&nbsp;ultimate&nbsp;temporary&nbsp;pointer&nbsp;that&nbsp;was&nbsp;used&nbsp;in&nbsp;the&nbsp;inner&nbsp;loop&nbsp;as&nbsp;a&nbsp;restricted&nbsp;pointer.&nbsp;Also,&nbsp;it's&nbsp;nonstandard,&nbsp;so&nbsp;if&nbsp;it&nbsp;is&nbsp;put&nbsp;in,&nbsp;make&nbsp;it&nbsp;so&nbsp;that&nbsp;it&nbsp;can&nbsp;be&nbsp;configured&nbsp;away.&lt;/FONT&gt;&lt;/P&gt;<br>
<br>
&lt;P&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;FONT&nbsp;SIZE=2&gt;Jim&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
&lt;BR&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;-----Original&nbsp;Message-----&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;From:&nbsp;Richard&nbsp;Guenther&nbsp;[&lt;A&nbsp;HREF=&quot;mailto:rguenth@tat.physik.uni-tuebingen.de&quot;&gt;mailto:rguenth@tat.physik.uni-tuebingen.de&lt;/A&gt;]&nbsp;&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;Sent:&nbsp;Wednesday,&nbsp;May&nbsp;28,&nbsp;2003&nbsp;7:59&nbsp;AM&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;To:&nbsp;pooma-dev@pooma.codesourcery.com&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;Subject:&nbsp;[pooma-dev]&nbsp;Brick&nbsp;engine&nbsp;and&nbsp;pointer&nbsp;aliasing&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;Hi!&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;Currently&nbsp;the&nbsp;data&nbsp;members&nbsp;of&nbsp;the&nbsp;Brick&nbsp;and&nbsp;BrickView&nbsp;engines&nbsp;are&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;_not_&nbsp;marked&nbsp;restrict,&nbsp;i.e.&nbsp;they're&nbsp;T&nbsp;*data_m.&nbsp;While&nbsp;strictly&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;speaking&nbsp;this&nbsp;is&nbsp;correct&nbsp;it&nbsp;harms&nbsp;performance&nbsp;on&nbsp;vector&nbsp;computers&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;quite&nbsp;a&nbsp;lot.&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;For&nbsp;dataparallel&nbsp;statements&nbsp;in&nbsp;POOMA&nbsp;the&nbsp;result&nbsp;is&nbsp;undefined,&nbsp;if&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;iterations&nbsp;depend&nbsp;on&nbsp;each&nbsp;other,&nbsp;which&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;that&nbsp;the&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;compiler&nbsp;may&nbsp;assume&nbsp;restrictness&nbsp;of&nbsp;all&nbsp;data_m&nbsp;pointers,&nbsp;here?&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;[note&nbsp;the&nbsp;question&nbsp;mark]&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;For&nbsp;non-dataparallel&nbsp;statements,&nbsp;the&nbsp;situation&nbsp;is&nbsp;more&nbsp;complicated.&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;While&nbsp;under&nbsp;the&nbsp;restrict&nbsp;assumption&nbsp;a&nbsp;loop&nbsp;like&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;for&nbsp;(i=0;&nbsp;i&lt;4;&nbsp;++i)&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&nbsp;&nbsp;A(i)&nbsp;=&nbsp;A(i-1);&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;is&nbsp;the&nbsp;same&nbsp;as&nbsp;non-restricted(?),&nbsp;if&nbsp;we&nbsp;have&nbsp;two&nbsp;views&nbsp;to&nbsp;the&nbsp;same&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;Array,&nbsp;things&nbsp;get&nbsp;messed&nbsp;up,&nbsp;as&nbsp;in&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;&nbsp;&nbsp;for&nbsp;(i=0;&nbsp;i&lt;4;&nbsp;++i)&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&nbsp;&nbsp;&nbsp;&nbsp;A(Interval1)(i)&nbsp;=&nbsp;A(Interval2)(i-1);&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;as&nbsp;now&nbsp;the&nbsp;iterations&nbsp;can&nbsp;be&nbsp;executed&nbsp;in&nbsp;parallel&nbsp;if&nbsp;BrickViews&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;have&nbsp;restricted&nbsp;data&nbsp;members.&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;The&nbsp;question&nbsp;now&nbsp;is,&nbsp;do&nbsp;we&nbsp;actually&nbsp;&quot;support&quot;&nbsp;such&nbsp;non-dataparallel&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;statements&nbsp;involving&nbsp;different&nbsp;views&nbsp;of&nbsp;the&nbsp;same&nbsp;Brick&nbsp;engine?&nbsp;Can&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;we&nbsp;specify&nbsp;such&nbsp;uses&nbsp;as&nbsp;undefined&nbsp;behavior?&nbsp;Can&nbsp;we&nbsp;mark&nbsp;Brick&nbsp;and&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;BrickView&nbsp;engine&nbsp;data_m&nbsp;members&nbsp;restrict?&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;Any&nbsp;thoughts&nbsp;on&nbsp;these&nbsp;issues?&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;Richard.&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;--&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;Richard&nbsp;Guenther&nbsp;&lt;richard&nbsp;dot&nbsp;guenther&nbsp;at&nbsp;uni-tuebingen&nbsp;dot&nbsp;de&gt;&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;WWW:&nbsp;&lt;A&nbsp;HREF=&quot;http://www.tat.physik.uni-tuebingen.de/~rguenth/&quot;&nbsp;TARGET=&quot;_blank&quot;&gt;http://www.tat.physik.uni-tuebingen.de/~rguenth/&lt;/A&gt;&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;/BODY&gt;<br>
&lt;/HTML&gt;
</tt>
