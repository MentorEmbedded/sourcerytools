<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;3.2//EN&quot;&gt;<br>
&lt;HTML&gt;<br>
&lt;HEAD&gt;<br>
&lt;META&nbsp;HTTP-EQUIV=&quot;Content-Type&quot;&nbsp;CONTENT=&quot;text/html;&nbsp;charset=us-ascii&quot;&gt;<br>
&lt;META&nbsp;NAME=&quot;Generator&quot;&nbsp;CONTENT=&quot;MS&nbsp;Exchange&nbsp;Server&nbsp;version&nbsp;5.5.2653.12&quot;&gt;<br>
&lt;TITLE&gt;RE:&nbsp;[pooma-dev]&nbsp;Assigning&nbsp;to&nbsp;internal&nbsp;guards&lt;/TITLE&gt;<br>
&lt;/HEAD&gt;<br>
&lt;BODY&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;We&nbsp;considered&nbsp;this&nbsp;and&nbsp;it&nbsp;was&nbsp;on&nbsp;the&nbsp;list&nbsp;of&nbsp;things&nbsp;to&nbsp;work&nbsp;on&nbsp;someday.&nbsp;If&nbsp;I&nbsp;remember&nbsp;correctly,&nbsp;we&nbsp;were&nbsp;going&nbsp;to&nbsp;try&nbsp;to&nbsp;figure&nbsp;out&nbsp;if&nbsp;the&nbsp;layouts&nbsp;all&nbsp;matched,&nbsp;including&nbsp;the&nbsp;numbers&nbsp;of&nbsp;internal&nbsp;guards,&nbsp;and&nbsp;if&nbsp;so,&nbsp;generate&nbsp;patch&nbsp;iterates&nbsp;that&nbsp;performed&nbsp;the&nbsp;operations&nbsp;on&nbsp;the&nbsp;entire&nbsp;domains,&nbsp;not&nbsp;just&nbsp;the&nbsp;physical&nbsp;domains.&nbsp;We&nbsp;already&nbsp;figure&nbsp;out&nbsp;if&nbsp;the&nbsp;layouts&nbsp;match&nbsp;at&nbsp;the&nbsp;physical-domain&nbsp;basis,&nbsp;I&nbsp;believe,&nbsp;so&nbsp;this&nbsp;didn't&nbsp;sound&nbsp;like&nbsp;a&nbsp;big&nbsp;extension.&nbsp;Indeed,&nbsp;the&nbsp;simplest&nbsp;form&nbsp;of&nbsp;this&nbsp;would&nbsp;be&nbsp;to&nbsp;check&nbsp;that&nbsp;everyone&nbsp;has&nbsp;exactly&nbsp;the&nbsp;same&nbsp;layout.&nbsp;&lt;/FONT&gt;&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;Of&nbsp;course,&nbsp;in&nbsp;multiple&nbsp;dimensions&nbsp;you&nbsp;generally&nbsp;don't&nbsp;want&nbsp;internal&nbsp;guards&nbsp;on&nbsp;anything&nbsp;that&nbsp;you're&nbsp;not&nbsp;going&nbsp;to&nbsp;stencil,&nbsp;so&nbsp;in&nbsp;practice&nbsp;it&nbsp;isn't&nbsp;clear&nbsp;how&nbsp;often&nbsp;this&nbsp;practice&nbsp;will&nbsp;really&nbsp;pay&nbsp;off.&nbsp;(Internal&nbsp;guards&nbsp;can&nbsp;consume&nbsp;a&nbsp;lot&nbsp;of&nbsp;memory&nbsp;in&nbsp;3D.)&lt;/FONT&gt;&lt;/P&gt;<br>
<br>
&lt;P&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;FONT&nbsp;SIZE=2&gt;Jim&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
&lt;BR&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;-----Original&nbsp;Message-----&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;From:&nbsp;Richard&nbsp;Guenther&nbsp;[&lt;A&nbsp;HREF=&quot;mailto:rguenth@tat.physik.uni-tuebingen.de&quot;&gt;mailto:rguenth@tat.physik.uni-tuebingen.de&lt;/A&gt;]&nbsp;&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;Sent:&nbsp;Wednesday,&nbsp;September&nbsp;25,&nbsp;2002&nbsp;3:51&nbsp;AM&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;To:&nbsp;pooma-dev@pooma.codesourcery.com&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;Subject:&nbsp;[pooma-dev]&nbsp;Assigning&nbsp;to&nbsp;internal&nbsp;guards&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;Hi!&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;I'd&nbsp;like&nbsp;to&nbsp;have&nbsp;internal&nbsp;guards&nbsp;computated&nbsp;rather&nbsp;than&nbsp;communicated&nbsp;in&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;simple&nbsp;cases&nbsp;like&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;&nbsp;x.all()&nbsp;=&nbsp;1.0;&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;or&nbsp;even&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;&nbsp;x(I)&nbsp;=&nbsp;a(I)&nbsp;+&nbsp;b(I);&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;so&nbsp;after&nbsp;the&nbsp;operation&nbsp;a&nbsp;x.fillGuards()&nbsp;will&nbsp;do&nbsp;nothing&nbsp;(is&nbsp;this&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;equivalent&nbsp;to&nbsp;having&nbsp;the&nbsp;dirty&nbsp;flag&nbsp;cleared&nbsp;after&nbsp;the&nbsp;operation&nbsp;or&nbsp;is&nbsp;the&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;dirty&nbsp;flag&nbsp;overloaded&nbsp;as&nbsp;I&nbsp;think&nbsp;with&nbsp;the&nbsp;handling&nbsp;of&nbsp;relations?).&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;I&nbsp;can&nbsp;achieve&nbsp;at&nbsp;least&nbsp;the&nbsp;assignment&nbsp;by&nbsp;creating&nbsp;a&nbsp;special&nbsp;layout&nbsp;for&nbsp;x&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;which&nbsp;contains&nbsp;overlapping&nbsp;patches&nbsp;with&nbsp;no&nbsp;guards,&nbsp;but&nbsp;I&nbsp;get&nbsp;extra&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;communication&nbsp;of&nbsp;guards&nbsp;at&nbsp;other&nbsp;places&nbsp;then&nbsp;which&nbsp;I&nbsp;dont&nbsp;really&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;understand.&nbsp;The&nbsp;layout&nbsp;is&nbsp;created&nbsp;using&nbsp;a&nbsp;custom&nbsp;partition&nbsp;based&nbsp;on&nbsp;grid&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;partition&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;OGridPartition&lt;1&gt;:&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&nbsp;&nbsp;blocks_m&nbsp;=&nbsp;[4]&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&nbsp;&nbsp;internalGuards_m:&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;upper&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lower&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&nbsp;&nbsp;num_m&nbsp;=&nbsp;4&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&nbsp;&nbsp;grid_m&nbsp;=&nbsp;(empty)&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;the&nbsp;resulting&nbsp;layout&nbsp;is&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;GridLayout&nbsp;1&nbsp;on&nbsp;global&nbsp;domain&nbsp;[-1:65:1]:&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&nbsp;&nbsp;&nbsp;Total&nbsp;subdomains:&nbsp;4&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&nbsp;&nbsp;&nbsp;Local&nbsp;subdomains:&nbsp;2&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&nbsp;&nbsp;Remote&nbsp;subdomains:&nbsp;2&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Grid&nbsp;blocks:&nbsp;[4]&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&nbsp;&nbsp;Global&nbsp;subdomain&nbsp;=&nbsp;{[-1:16:1]:&nbsp;allocated=[-1:16:1],&nbsp;con=0,&nbsp;aff=0,&nbsp;gid=0,&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;lid=0}&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&nbsp;&nbsp;Global&nbsp;subdomain&nbsp;=&nbsp;{[15:32:1]:&nbsp;allocated=[15:32:1],&nbsp;con=0,&nbsp;aff=0,&nbsp;gid=1,&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;lid=1}&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&nbsp;&nbsp;Global&nbsp;subdomain&nbsp;=&nbsp;{[31:48:1]:&nbsp;allocated=[31:48:1],&nbsp;con=1,&nbsp;aff=-1,&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;gid=2,&nbsp;lid=-1}&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&nbsp;&nbsp;Global&nbsp;subdomain&nbsp;=&nbsp;{[47:65:1]:&nbsp;allocated=[47:65:1],&nbsp;con=1,&nbsp;aff=-1,&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;gid=3,&nbsp;lid=-1}&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&nbsp;&nbsp;&nbsp;Local&nbsp;subdomain&nbsp;=&nbsp;{[-1:16:1]:&nbsp;allocated=[-1:16:1],&nbsp;con=0,&nbsp;aff=0,&nbsp;gid=0,&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;lid=0}&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&nbsp;&nbsp;&nbsp;Local&nbsp;subdomain&nbsp;=&nbsp;{[15:32:1]:&nbsp;allocated=[15:32:1],&nbsp;con=0,&nbsp;aff=0,&nbsp;gid=1,&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;lid=1}&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&nbsp;&nbsp;Remote&nbsp;subdomain&nbsp;=&nbsp;{[31:48:1]:&nbsp;allocated=[31:48:1],&nbsp;con=1,&nbsp;aff=-1,&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;gid=2,&nbsp;lid=-1}&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&nbsp;&nbsp;Remote&nbsp;subdomain&nbsp;=&nbsp;{[47:65:1]:&nbsp;allocated=[47:65:1],&nbsp;con=1,&nbsp;aff=-1,&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;gid=3,&nbsp;lid=-1}&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&nbsp;hasInternalGuards_m,&nbsp;hasExternalGuards_m&nbsp;0&nbsp;0&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&nbsp;internalGuards_m&nbsp;0-0&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&nbsp;externalGuards_m&nbsp;0-0&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&nbsp;gcFillList_m&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
&lt;BR&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;Anyone&nbsp;with&nbsp;other/better&nbsp;ideas&nbsp;to&nbsp;reduce&nbsp;communication?&nbsp;I'm&nbsp;still&nbsp;unable&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;to&nbsp;find&nbsp;where&nbsp;the&nbsp;computation&nbsp;domain&nbsp;for&nbsp;the&nbsp;patches&nbsp;is&nbsp;computed&nbsp;and&nbsp;the&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;dirty&nbsp;flag&nbsp;is&nbsp;handled&nbsp;-&nbsp;it&nbsp;semms&nbsp;to&nbsp;be&nbsp;spread&nbsp;over&nbsp;the&nbsp;whole&nbsp;code...&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;Any&nbsp;hints?&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&nbsp;&nbsp;&nbsp;&nbsp;Thanks,&nbsp;Richard.&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;--&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;Richard&nbsp;Guenther&nbsp;&lt;richard.guenther@uni-tuebingen.de&gt;&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;WWW:&nbsp;&lt;A&nbsp;HREF=&quot;http://www.tat.physik.uni-tuebingen.de/~rguenth/&quot;&nbsp;TARGET=&quot;_blank&quot;&gt;http://www.tat.physik.uni-tuebingen.de/~rguenth/&lt;/A&gt;&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;The&nbsp;GLAME&nbsp;Project:&nbsp;&lt;A&nbsp;HREF=&quot;http://www.glame.de/&quot;&nbsp;TARGET=&quot;_blank&quot;&gt;http://www.glame.de/&lt;/A&gt;&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;/BODY&gt;<br>
&lt;/HTML&gt;
</tt>
