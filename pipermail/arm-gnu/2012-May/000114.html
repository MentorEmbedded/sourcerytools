<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [arm-gnu] undefined instruction
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:arm-gnu%40codesourcery.com?Subject=Re%3A%20%5Barm-gnu%5D%20undefined%20instruction&In-Reply-To=%3C4FB40899.7090705%40mentor.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000112.html">
   <LINK REL="Next"  HREF="000115.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[arm-gnu] undefined instruction</H1>
    <B>Carlos O'Donell</B> 
    <A HREF="mailto:arm-gnu%40codesourcery.com?Subject=Re%3A%20%5Barm-gnu%5D%20undefined%20instruction&In-Reply-To=%3C4FB40899.7090705%40mentor.com%3E"
       TITLE="[arm-gnu] undefined instruction">carlos_odonell at mentor.com
       </A><BR>
    <I>Wed May 16 20:05:45 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="000112.html">[arm-gnu] undefined instruction
</A></li>
        <LI>Next message: <A HREF="000115.html">[arm-gnu] undefined instruction
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#114">[ date ]</a>
              <a href="thread.html#114">[ thread ]</a>
              <a href="subject.html#114">[ subject ]</a>
              <a href="author.html#114">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 5/16/2012 3:43 PM, Carlo Caione wrote:
&gt;<i> On Wed, May 16, 2012 at 1:04 AM, Carlos O'Donell
</I>&gt;<i> &lt;<A HREF="http://sourcerytools.com/cgi-bin/mailman/listinfo/arm-gnu">carlos_odonell at mentor.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> What did you use to get this disassembly?
</I>&gt;<i> 
</I>&gt;<i> arm-none-aebi-gdb in eclipse. Without eclipse is (obviously :) the same:
</I>&gt;<i> 
</I>&gt;<i> (gdb) disassemble
</I>&gt;<i> Dump of assembler code for function strlen:
</I>&gt;<i> =&gt; 0x40205c84 &lt;+0&gt;:    beq    0x40205d18 &lt;memcpy&gt;
</I>&gt;<i>    0x40205c88 &lt;+4&gt;:            ; &lt;UNDEFINED&gt; instruction: 0xf03fe03a
</I>&gt;<i>    0x40205c8c &lt;+8&gt;:    andeq    r0, r0, r6
</I>&gt;<i>    0x40205c90 &lt;+12&gt;:    andeq    r0, r0, r4
</I>&gt;<i>    0x40205c94 &lt;+16&gt;:    andeq    r0, r0, r7
</I>&gt;<i>    0x40205c98 &lt;+20&gt;:    andeq    r0, r0, sp, lsl r0
</I>&gt;<i>    0x40205c9c &lt;+24&gt;:    ldrdmi    r0, [r0], -r3
</I>&gt;<i>    0x40205ca0 &lt;+28&gt;:            ; &lt;UNDEFINED&gt; instruction: 0xffffffff
</I>&gt;<i> End of assembler dump.
</I>
Either gdb thinks this is wrong architecture/endian, or you didn't load anything and it's disassembling garbage from memory, or the probe is returning garbage for that memory location. You need to rule these out one at a time.

Switch to the gdb console and issue `show architecture', then issue `show endian', what does it show?

&gt;&gt;<i> When you compile with -save-temps what does the output assembly look like before being assembled?
</I>
That looks good.

&gt;<i> This is the disassebly of the object file:
</I>
This looks good.

&gt;&gt;<i> It might be that the mapping symbols are missing and your disassembling constant pool data.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> What are the .gnu_attribute flags for the object file?
</I>&gt;<i> 
</I>&gt;<i> I don't have any flags (If I have correctly understood what you mean).
</I>
Run `*-readelf -Wa` on your file (there is an run external tool for this in the IDE), and provide the output of the &quot;Attribute section&quot;

e.g.

Attribute Section: aeabi
File Attributes
  Tag_CPU_name: &quot;ARM7TDMI&quot;
  Tag_CPU_arch: v4T
  Tag_ARM_ISA_use: Yes
  Tag_THUMB_ISA_use: Thumb-1
  Tag_FP_arch: VFPv2
  Tag_ABI_PCS_wchar_t: 4
  Tag_ABI_FP_denormal: Needed
  Tag_ABI_FP_exceptions: Needed
  Tag_ABI_FP_number_model: IEEE 754
  Tag_ABI_align_needed: 8-byte
  Tag_ABI_enum_size: small
  Tag_DIV_use: Not allowed


Cheers,
Carlos.
-- 
Carlos O'Donell
Mentor Graphics / CodeSourcery
<A HREF="http://sourcerytools.com/cgi-bin/mailman/listinfo/arm-gnu">carlos_odonell at mentor.com</A>
<A HREF="http://sourcerytools.com/cgi-bin/mailman/listinfo/arm-gnu">carlos at codesourcery.com</A>
+1 (613) 963 1026

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000112.html">[arm-gnu] undefined instruction
</A></li>
	<LI>Next message: <A HREF="000115.html">[arm-gnu] undefined instruction
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#114">[ date ]</a>
              <a href="thread.html#114">[ thread ]</a>
              <a href="subject.html#114">[ subject ]</a>
              <a href="author.html#114">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://sourcerytools.com/cgi-bin/mailman/listinfo/arm-gnu">More information about the arm-gnu
mailing list</a><br>
</body></html>
