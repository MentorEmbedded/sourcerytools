<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [arm-gnu] undefined instruction
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:arm-gnu%40codesourcery.com?Subject=Re%3A%20%5Barm-gnu%5D%20undefined%20instruction&In-Reply-To=%3C4FB50A4E.8090607%40mentor.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000115.html">
   <LINK REL="Next"  HREF="000110.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[arm-gnu] undefined instruction</H1>
    <B>Carlos O'Donell</B> 
    <A HREF="mailto:arm-gnu%40codesourcery.com?Subject=Re%3A%20%5Barm-gnu%5D%20undefined%20instruction&In-Reply-To=%3C4FB50A4E.8090607%40mentor.com%3E"
       TITLE="[arm-gnu] undefined instruction">carlos_odonell at mentor.com
       </A><BR>
    <I>Thu May 17 14:25:18 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="000115.html">[arm-gnu] undefined instruction
</A></li>
        <LI>Next message: <A HREF="000110.html">[arm-gnu] building the lite package in Ubuntu or MAC OS X
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#116">[ date ]</a>
              <a href="thread.html#116">[ thread ]</a>
              <a href="subject.html#116">[ subject ]</a>
              <a href="author.html#116">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 5/16/2012 5:27 PM, Carlo Caione wrote:
&gt;<i> Ok, I think I have spotted the bug. And actually the problem seems to
</I>&gt;<i> me related to qemu-linaro (yes, I'm emulating a Cortex-A8 with qemu)
</I>&gt;<i> and not to CodeSourcery.
</I>&gt;<i> In fact in the code an exact point does exist in which the strlen
</I>&gt;<i> routine gets corrupted.
</I>...
&gt;<i> 0x402000f0 in __mmu_cache_flush ()
</I>&gt;<i> (gdb) disassemble strlen
</I>&gt;<i> Dump of assembler code for function strlen:
</I>&gt;<i>    0x40205c84 &lt;+0&gt;:	beq	0x40205d18 &lt;memcpy&gt;
</I>&gt;<i>    0x40205c88 &lt;+4&gt;:			; &lt;UNDEFINED&gt; instruction: 0xf03fe03a
</I>&gt;<i>    0x40205c8c &lt;+8&gt;:	andeq	r0, r0, r6
</I>&gt;<i>    0x40205c90 &lt;+12&gt;:	andeq	r0, r0, r4
</I>&gt;<i>    0x40205c94 &lt;+16&gt;:	andeq	r0, r0, r7
</I>&gt;<i>    0x40205c98 &lt;+20&gt;:	andeq	r0, r0, sp, lsl r0
</I>&gt;<i>    0x40205c9c &lt;+24&gt;:	ldrdmi	r0, [r0], -r3
</I>&gt;<i>    0x40205ca0 &lt;+28&gt;:			; &lt;UNDEFINED&gt; instruction: 0xffffffff
</I>&gt;<i> End of assembler dump.
</I>&gt;<i> (gdb)
</I>&gt;<i> 
</I>&gt;<i> So, is this a qemu-linaro bug?
</I>
It is most likely either a bug in the cache handling routines or a bug in QEMU's MMU emulation for the Cortex-A8.

I would suggest you test upstream QEMU to see if this is fixed.

If it is then you can then track down the fix and ask Linaro to backport.

If it's not fixed you need to put together a test case for upstream QEMU and report the issue there.

Cheers,
Carlos.
-- 
Carlos O'Donell
Mentor Graphics / CodeSourcery
<A HREF="http://sourcerytools.com/cgi-bin/mailman/listinfo/arm-gnu">carlos_odonell at mentor.com</A>
<A HREF="http://sourcerytools.com/cgi-bin/mailman/listinfo/arm-gnu">carlos at codesourcery.com</A>
+1 (613) 963 1026

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000115.html">[arm-gnu] undefined instruction
</A></li>
	<LI>Next message: <A HREF="000110.html">[arm-gnu] building the lite package in Ubuntu or MAC OS X
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#116">[ date ]</a>
              <a href="thread.html#116">[ thread ]</a>
              <a href="subject.html#116">[ subject ]</a>
              <a href="author.html#116">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://sourcerytools.com/cgi-bin/mailman/listinfo/arm-gnu">More information about the arm-gnu
mailing list</a><br>
</body></html>
