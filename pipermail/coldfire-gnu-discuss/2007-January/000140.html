<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [coldfire-gnu-discuss] The option -fkeep-static-consts
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:coldfire-gnu-discuss%40codesourcery.com?Subject=Re%3A%20%5Bcoldfire-gnu-discuss%5D%20The%20option%20-fkeep-static-consts&In-Reply-To=%3C459D6166.2000703%40codesourcery.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000139.html">
   <LINK REL="Next"  HREF="000141.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[coldfire-gnu-discuss] The option -fkeep-static-consts</H1>
    <B>Mark Mitchell</B> 
    <A HREF="mailto:coldfire-gnu-discuss%40codesourcery.com?Subject=Re%3A%20%5Bcoldfire-gnu-discuss%5D%20The%20option%20-fkeep-static-consts&In-Reply-To=%3C459D6166.2000703%40codesourcery.com%3E"
       TITLE="[coldfire-gnu-discuss] The option -fkeep-static-consts">mark at codesourcery.com
       </A><BR>
    <I>Thu Jan  4 20:19:50 UTC 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000139.html">The option -fkeep-static-consts
</A></li>
        <LI>Next message: <A HREF="000141.html">Warning messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#140">[ date ]</a>
              <a href="thread.html#140">[ thread ]</a>
              <a href="subject.html#140">[ subject ]</a>
              <a href="author.html#140">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>DMS Tech, John wrote:
&gt;<i> I am using the G++ 4.1-32 version. I have some static constants in my
</I>&gt;<i> code and whenever I use a optimization option (-O1, ..) these static
</I>&gt;<i> constants disappear from my compiled output file.
</I>
The compiler is behaving as expected:

`-fkeep-static-consts'
     Emit variables declared `static const' when optimization isn't
     turned on, even if the variables aren't referenced.

When optimization is on, the compiler always removes unreferenced static
constants.  Older versions of the compiler may not have been smart
enough to do so.

The option is actually intended to be used in the negative:

  m68k-elf-gcc -g -fno-keep-static-consts a.c

compiles a.c without optimization, but throws away unreferenced static
constants.  Without the option, they would be kept.

To keep the static ocnstants at all optimization levels, use the &quot;used'
attribute:

  static const int i __attribute__((used)) = 7;

-- 
Mark Mitchell
CodeSourcery
<A HREF="http://sourcerytools.com/cgi-bin/mailman/listinfo/coldfire-gnu-discuss">mark at codesourcery.com</A>
(650) 331-3385 x713

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000139.html">The option -fkeep-static-consts
</A></li>
	<LI>Next message: <A HREF="000141.html">Warning messages
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#140">[ date ]</a>
              <a href="thread.html#140">[ thread ]</a>
              <a href="subject.html#140">[ subject ]</a>
              <a href="author.html#140">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://sourcerytools.com/cgi-bin/mailman/listinfo/coldfire-gnu-discuss">More information about the coldfire-gnu-discuss
mailing list</a><br>
</body></html>
