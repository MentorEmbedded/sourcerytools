<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> page size change on MIPS
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mips-gnu-discuss%40codesourcery.com?Subject=Re%3A%20page%20size%20change%20on%20MIPS&In-Reply-To=%3CAANLkTinsRxKhw-r0LBzwSMpiYs8eK1G26Z%3DgWwPuRu%3Di%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="000048.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>page size change on MIPS</H1>
    <B>keshav yadav</B> 
    <A HREF="mailto:mips-gnu-discuss%40codesourcery.com?Subject=Re%3A%20page%20size%20change%20on%20MIPS&In-Reply-To=%3CAANLkTinsRxKhw-r0LBzwSMpiYs8eK1G26Z%3DgWwPuRu%3Di%40mail.gmail.com%3E"
       TITLE="page size change on MIPS">keshav.yadav2005 at gmail.com
       </A><BR>
    <I>Fri Feb  4 06:02:40 UTC 2011</I>
    <P><UL>
        
        <LI>Next message: <A HREF="000048.html">page size change on MIPS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#47">[ date ]</a>
              <a href="thread.html#47">[ thread ]</a>
              <a href="subject.html#47">[ subject ]</a>
              <a href="author.html#47">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi All,

I observe one different behavior when we have page size set to 4KB or
16KB in kernel busybox receive argc[0] argument correct, but
when page size set to 64KB I am getting argv[0] as empty. So what may
be issue. I am using codesourcercy toolchain.

Kind regards




---------- Forwarded message ----------
From: naveen yadav &lt;<A HREF="http://sourcerytools.com/cgi-bin/mailman/listinfo/mips-gnu-discuss">yad.naveen at gmail.com</A>&gt;
Date: Fri, Feb 4, 2011 at 9:46 AM
Subject: Re: page size change on MIPS
To: Ralf Baechle &lt;<A HREF="http://sourcerytools.com/cgi-bin/mailman/listinfo/mips-gnu-discuss">ralf at linux-mips.org</A>&gt;
Cc: <A HREF="http://sourcerytools.com/cgi-bin/mailman/listinfo/mips-gnu-discuss">kernelnewbies at nl.linux.org</A>, Himanshu Aggarwal
&lt;<A HREF="http://sourcerytools.com/cgi-bin/mailman/listinfo/mips-gnu-discuss">lkml.himanshu at gmail.com</A>&gt;, David Daney &lt;<A HREF="http://sourcerytools.com/cgi-bin/mailman/listinfo/mips-gnu-discuss">ddaney at caviumnetworks.com</A>&gt;,
<A HREF="http://sourcerytools.com/cgi-bin/mailman/listinfo/mips-gnu-discuss">linux-mips at linux-mips.org</A>


Hi, I am adding readelf info also .

mips-linux-gnu-readelf -S squashfs-root/bin/busybox
There are 35 section headers, starting at offset 0x174290:

Section Headers:
&#160;[Nr] Name &#160; &#160; &#160; &#160; &#160; &#160; &#160;Type &#160; &#160; &#160; &#160; &#160; &#160;Addr &#160; &#160; Off &#160; &#160;Size &#160; ES Flg Lk Inf Al
&#160;[ 0] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; NULL &#160; &#160; &#160; &#160; &#160; &#160;00000000 000000 000000 00 &#160; &#160; &#160;0 &#160; 0 &#160;0
&#160;[ 1] .note.ABI-tag &#160; &#160; NOTE &#160; &#160; &#160; &#160; &#160; &#160;004000d4 0000d4 000020 00 &#160; A &#160;0 &#160; 0 &#160;4
&#160;[ 2] .reginfo &#160; &#160; &#160; &#160; &#160;MIPS_REGINFO &#160; &#160;004000f4 0000f4 000018 18 &#160; A &#160;0 &#160; 0 &#160;4
&#160;[ 3] .rel.dyn &#160; &#160; &#160; &#160; &#160;REL &#160; &#160; &#160; &#160; &#160; &#160; 0040010c 00010c 000010 08 &#160; A &#160;0 &#160; 0 &#160;4
&#160;[ 4] .init &#160; &#160; &#160; &#160; &#160; &#160; PROGBITS &#160; &#160; &#160; &#160;0040011c 00011c 00005c 00 &#160;AX &#160;0 &#160; 0 &#160;4
&#160;[ 5] .text &#160; &#160; &#160; &#160; &#160; &#160; PROGBITS &#160; &#160; &#160; &#160;00400180 000180 11d2b0 00 &#160;AX &#160;0 &#160; 0 16
&#160;[ 6] __libc_freeres_fn PROGBITS &#160; &#160; &#160; &#160;0051d430 11d430 001368 00 &#160;AX &#160;0 &#160; 0 &#160;4
&#160;[ 7] __libc_thread_fre PROGBITS &#160; &#160; &#160; &#160;0051e798 11e798 000148 00 &#160;AX &#160;0 &#160; 0 &#160;4
&#160;[ 8] .fini &#160; &#160; &#160; &#160; &#160; &#160; PROGBITS &#160; &#160; &#160; &#160;0051e8e0 11e8e0 000034 00 &#160;AX &#160;0 &#160; 0 &#160;4
&#160;[ 9] .rodata &#160; &#160; &#160; &#160; &#160; PROGBITS &#160; &#160; &#160; &#160;0051e920 11e920 02d560 00 &#160; A &#160;0 &#160; 0 16
&#160;[10] __libc_subfreeres PROGBITS &#160; &#160; &#160; &#160;0054be80 14be80 000058 00 &#160; A &#160;0 &#160; 0 &#160;4
&#160;[11] __libc_atexit &#160; &#160; PROGBITS &#160; &#160; &#160; &#160;0054bed8 14bed8 000004 00 &#160; A &#160;0 &#160; 0 &#160;4
&#160;[12] __libc_thread_sub PROGBITS &#160; &#160; &#160; &#160;0054bedc 14bedc 000008 00 &#160; A &#160;0 &#160; 0 &#160;4
&#160;[13] .gcc_except_table PROGBITS &#160; &#160; &#160; &#160;0054bee4 14bee4 0001fb 00 &#160; A &#160;0 &#160; 0 &#160;1
&#160;[14] .eh_frame &#160; &#160; &#160; &#160; PROGBITS &#160; &#160; &#160; &#160;0055c0e0 14c0e0 002464 00 &#160;WA &#160;0 &#160; 0 &#160;4
&#160;[15] .tdata &#160; &#160; &#160; &#160; &#160; &#160;PROGBITS &#160; &#160; &#160; &#160;0055e544 14e544 000018 00 WAT &#160;0 &#160; 0 &#160;4
&#160;[16] .tbss &#160; &#160; &#160; &#160; &#160; &#160; NOBITS &#160; &#160; &#160; &#160; &#160;0055e55c 14e55c 000034 00 WAT &#160;0 &#160; 0 &#160;4
&#160;[17] .ctors &#160; &#160; &#160; &#160; &#160; &#160;PROGBITS &#160; &#160; &#160; &#160;0055e55c 14e55c 000008 00 &#160;WA &#160;0 &#160; 0 &#160;4
&#160;[18] .dtors &#160; &#160; &#160; &#160; &#160; &#160;PROGBITS &#160; &#160; &#160; &#160;0055e564 14e564 00000c 00 &#160;WA &#160;0 &#160; 0 &#160;4
&#160;[19] .jcr &#160; &#160; &#160; &#160; &#160; &#160; &#160;PROGBITS &#160; &#160; &#160; &#160;0055e570 14e570 000004 00 &#160;WA &#160;0 &#160; 0 &#160;4
&#160;[20] .data.rel.ro &#160; &#160; &#160;PROGBITS &#160; &#160; &#160; &#160;0055e574 14e574 000030 00 &#160;WA &#160;0 &#160; 0 &#160;4
&#160;[21] .data &#160; &#160; &#160; &#160; &#160; &#160; PROGBITS &#160; &#160; &#160; &#160;0055e5b0 14e5b0 000b30 00 &#160;WA &#160;0 &#160; 0 16
&#160;[22] .got &#160; &#160; &#160; &#160; &#160; &#160; &#160;PROGBITS &#160; &#160; &#160; &#160;0055f0e0 14f0e0 000148 04 WAp &#160;0 &#160; 0 16
&#160;[23] .sdata &#160; &#160; &#160; &#160; &#160; &#160;PROGBITS &#160; &#160; &#160; &#160;0055f228 14f228 000004 00 WAp &#160;0 &#160; 0 &#160;4
&#160;[24] .sbss &#160; &#160; &#160; &#160; &#160; &#160; NOBITS &#160; &#160; &#160; &#160; &#160;0055f230 14f22c 000184 00 WAp &#160;0 &#160; 0 &#160;8
&#160;[25] .bss &#160; &#160; &#160; &#160; &#160; &#160; &#160;NOBITS &#160; &#160; &#160; &#160; &#160;0055f3c0 14f22c 00516c 00 &#160;WA &#160;0 &#160; 0 16
&#160;[26] __libc_freeres_pt NOBITS &#160; &#160; &#160; &#160; &#160;0056452c 14f22c 000040 00 &#160;WA &#160;0 &#160; 0 &#160;4
&#160;[27] .pdr &#160; &#160; &#160; &#160; &#160; &#160; &#160;PROGBITS &#160; &#160; &#160; &#160;00000000 14f22c 016880 00 &#160; &#160; &#160;0 &#160; 0 &#160;4
&#160;[28] .comment &#160; &#160; &#160; &#160; &#160;PROGBITS &#160; &#160; &#160; &#160;00000000 165aac 0027e0 00 &#160; &#160; &#160;0 &#160; 0 &#160;1
&#160;[29] .debug_frame &#160; &#160; &#160;MIPS_DWARF &#160; &#160; &#160;00000000 16828c 00be88 00 &#160; &#160; &#160;0 &#160; 0 &#160;4
&#160;[30] .gnu.attributes &#160; LOOS+ffffff5 &#160; &#160;00000000 174114 000010 00 &#160; &#160; &#160;0 &#160; 0 &#160;1
&#160;[31] .mdebug.abi32 &#160; &#160; PROGBITS &#160; &#160; &#160; &#160;000030c0 174124 000000 00 &#160; &#160; &#160;0 &#160; 0 &#160;1
&#160;[32] .shstrtab &#160; &#160; &#160; &#160; STRTAB &#160; &#160; &#160; &#160; &#160;00000000 174124 00016c 00 &#160; &#160; &#160;0 &#160; 0 &#160;1
&#160;[33] .symtab &#160; &#160; &#160; &#160; &#160; SYMTAB &#160; &#160; &#160; &#160; &#160;00000000 174808 015320 10
34 2843 &#160;4
&#160;[34] .strtab &#160; &#160; &#160; &#160; &#160; STRTAB &#160; &#160; &#160; &#160; &#160;00000000 189b28 012f65 00 &#160; &#160; &#160;0 &#160; 0 &#160;1
Key to Flags:
&#160;W (write), A (alloc), X (execute), M (merge), S (strings)
&#160;I (info), L (link order), G (group), x (unknown)
&#160;O (extra OS processing required) o (OS specific), p (processor specific)


On Fri, Feb 4, 2011 at 8:54 AM, naveen yadav &lt;<A HREF="http://sourcerytools.com/cgi-bin/mailman/listinfo/mips-gnu-discuss">yad.naveen at gmail.com</A>&gt; wrote:
&gt;<i> thanaks a lot for your suggestion ..
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I debug this issue further, and here is my observations:
</I>&gt;<i>
</I>&gt;<i> 1. If I replace init with simple static link executable binary, this
</I>&gt;<i> can be executed.
</I>&gt;<i> 2. In case of busy-box, I debug the reason why init fails to excute.
</I>&gt;<i>
</I>&gt;<i> When I execute init command from busybox the control goes in main()
</I>&gt;<i> function of busybox(appletlib.c) with argv value
</I>&gt;<i> as the command you are suppose to execute, which in our case is init.
</I>&gt;<i>
</I>&gt;<i> But when i check argv is coming null when page size is 64KB and it
</I>&gt;<i> comes init when page size is 16KB.
</I>&gt;<i>
</I>&gt;<i> This behaviour is very strange and i am still debugging this issue.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I have check in Glibc, the max_page size it support is 64 KB in
</I>&gt;<i> codesourcercy toolchain 4.4.1
</I>&gt;<i>
</I>&gt;<i> How can I check alignment issue as mention by Mr. Ralf Baechle.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Kind regards
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Mon, Jan 31, 2011 at 6:38 PM, Ralf Baechle &lt;<A HREF="http://sourcerytools.com/cgi-bin/mailman/listinfo/mips-gnu-discuss">ralf at linux-mips.org</A>&gt; wrote:
</I>&gt;&gt;<i> On Sun, Jan 30, 2011 at 08:32:43PM +0530, Himanshu Aggarwal wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Why should the application or the toolchains depend on pagesize? I am
</I>&gt;&gt;&gt;<i> not very clear on this. Can someone explain it?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> To allow loading directly with mmap the executable file's layout must
</I>&gt;&gt;<i> be such that it's it's segments are on offsets that are a multiple of
</I>&gt;&gt;<i> the page size so in turn the linker must know that alignment.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &#160;Ralf
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>
_______________________________________________
Kernelnewbies mailing list
<A HREF="http://sourcerytools.com/cgi-bin/mailman/listinfo/mips-gnu-discuss">Kernelnewbies at kernelnewbies.org</A>
<A HREF="http://lists.kernelnewbies.org/mailman/listinfo/kernelnewbies">http://lists.kernelnewbies.org/mailman/listinfo/kernelnewbies</A>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="000048.html">page size change on MIPS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#47">[ date ]</a>
              <a href="thread.html#47">[ thread ]</a>
              <a href="subject.html#47">[ subject ]</a>
              <a href="author.html#47">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://sourcerytools.com/cgi-bin/mailman/listinfo/mips-gnu-discuss">More information about the mips-gnu-discuss
mailing list</a><br>
</body></html>
